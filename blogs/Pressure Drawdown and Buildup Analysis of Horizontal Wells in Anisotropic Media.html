<html>
<head>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
        }
        h1, h2, h3 {
            color: #2c3e50;
        }
        h1 {
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
        }
        h2 {
            border-bottom: 1px solid #bdc3c7;
            padding-bottom: 5px;
            margin-top: 30px;
        }
        .formula-block {
            background-color: #f9f9f9;
            padding: 15px;
            border-left: 4px solid #3498db;
            margin: 20px 0;
            overflow-x: auto;
        }
        .highlight {
            background-color: #ffffcc;
            padding: 2px 4px;
        }
        .example {
            background-color: #e8f4f8;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
        }
        .note {
            background-color: #f8f4e8;
            padding: 15px;
            border-left: 4px solid #f39c12;
            margin: 20px 0;
        }
        #simulator {
            border: 1px solid #ddd;
            padding: 20px;
            border-radius: 5px;
            margin: 30px 0;
            background-color: #f5f5f5;
        }
        .slider-container {
            margin: 15px 0;
        }
        .slider {
            width: 80%;
        }
        canvas {
            border: 1px solid #ddd;
            background-color: white;
        }
        table {
            border-collapse: collapse;
            width: 100%;
            margin: 20px 0;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
        code {
            font-family: Consolas, Monaco, 'Andale Mono', monospace;
            background-color: #f5f5f5;
            padding: 2px 4px;
            border-radius: 3px;
        }
    </style>
</head>
<body>
    <h1>Understanding Horizontal Well Pressure Analysis: A First Principles Approach</h1>
    
    <p>When I first encountered the paper "Pressure Drawdown and Buildup Analysis of Horizontal Wells in Anisotropic Media" by Goode and Thambynayagam, I was struck by how a seemingly complex topic could be broken down into fundamental principles. Today, I want to take you on a journey through the fascinating world of horizontal well testing, explaining it from first principles so that even if you're new to petroleum engineering, you'll grasp the core concepts.</p>
    
    <h2>Why Horizontal Wells Matter</h2>
    
    <p>Before diving into the mathematics, let's understand why horizontal wells are important. Imagine you have a thin layer of oil sandwiched between rock. A traditional vertical well would only contact a small portion of this layer, but a horizontal well can run along the layer, dramatically increasing contact with the oil-bearing formation.</p>
    
    <p>This increased contact area is why horizontal wells can be 3-5 times more productive than vertical wells in the right formations. They're particularly valuable in:</p>
    
    <ul>
        <li>Thin reservoirs where vertical wells would have limited contact</li>
        <li>Formations with natural fractures that can be intersected</li>
        <li>Situations where water or gas coning is a concern</li>
    </ul>
    
    <div class="note">
        <strong>Historical Context:</strong> While horizontal drilling technology dates back to the 1940s, it wasn't until the late 1970s and 1980s that significant advancements made horizontal wells economically viable. Today, they're essential for unconventional resource development, including shale oil and gas production.
    </div>
    
    <h2>The Fundamental Problem: How Fluid Flows Around a Horizontal Well</h2>
    
    <p>At its core, understanding pressure behavior in horizontal wells requires us to solve a fluid flow problem. When fluid moves through porous rock toward a horizontal wellbore, it creates pressure disturbances that propagate through the reservoir in complex patterns.</p>
    
    <p>Let's start with the governing equation. The flow of slightly compressible fluid in a porous medium is described by the diffusion equation:</p>
    
    <div class="formula-block">
        $$\frac{\phi\mu c_{t}}{k_{y}}\frac{\partial p}{\partial t}=\frac{k_{x}}{k_{y}}\frac{\partial^{2}p}{\partial x^{2}}+\frac{\partial^{2}p}{\partial y^{2}}+\frac{k_{z}}{k_{y}}\frac{\partial^{2}p}{\partial z^{2}}$$
    </div>
    
    <p>This intimidating equation actually represents something quite intuitive: how pressure changes over time at any point in the reservoir. Let's break it down:</p>
    
    <ul>
        <li>\(\phi\) is porosity - the percentage of the rock that's empty space</li>
        <li>\(\mu\) is fluid viscosity - how "thick" or resistant to flow the fluid is</li>
        <li>\(c_t\) is total compressibility - how much the fluid and rock compress under pressure</li>
        <li>\(k_x\), \(k_y\), and \(k_z\) are permeabilities in different directions - how easily fluid flows through the rock</li>
        <li>\(p\) is pressure</li>
        <li>\(t\) is time</li>
    </ul>
    
    <p>Think of this equation as describing how pressure "diffuses" through the reservoir - similar to how heat spreads through a metal rod, but in three dimensions and with complications due to the properties of the rock and fluid.</p>
    
    <h2>The Unique Challenge of Horizontal Wells</h2>
    
    <p>What makes horizontal wells special is their geometry. Unlike vertical wells that can often be treated as simple point sources, horizontal wells create complex, three-dimensional flow patterns that change over time.</p>
    
    <p>To visualize this, imagine dropping a long, thin rod into a pool of water. The ripples would spread out in patterns very different from those created by dropping a small pebble.</p>
    
    <h2>Flow Regimes: The Key to Understanding Pressure Behavior</h2>
    
    <p>One of the most powerful insights from Goode and Thambynayagam's work is the identification of distinct flow regimes that develop at different times during a pressure test. These flow regimes are like chapters in a story, each revealing different information about the reservoir.</p>
    
    <p>Let's examine these flow regimes from first principles:</p>
    
    <h3>1. Early Time: Radial Flow Around the Wellbore</h3>
    
    <p>When we first start producing from a horizontal well, the fluid nearby rushes toward the wellbore from all directions. At this stage, the flow is essentially radial around the well, similar to what we'd see with a vertical well.</p>
    
    <div class="formula-block">
        $$p_{i}-p_{wf}=\frac{162.6q\mu B_{o}}{\sqrt{k_{z}k_{y}}L_{w}}\left[\log_{10}\left(\frac{\sqrt{k_{y}k_{z}}t}{\phi\mu c_{t}r_{w}^{2}}\right)-3.227+0.868S_{m}\right]$$
    </div>
    
    <p>This equation tells us that if we plot pressure vs. logarithm of time, we'll get a straight line whose slope is related to the geometric mean of vertical and horizontal permeabilities (\(\sqrt{k_z k_y}\)).</p>
    
    <h3>2. Intermediate Time: Linear Flow</h3>
    
    <p>As time progresses, the pressure disturbance reaches the top and bottom boundaries of the reservoir. When this happens, flow can no longer come from those directions, and instead becomes predominantly linear, perpendicular to the well axis.</p>
    
    <div class="formula-block">
        $$p_{i}-p_{wf}=\frac{8.128q B_{o}}{L_{w}h_{z}}\sqrt{\frac{\mu t}{k_{y}\phi c_{t}}}+\frac{141.2q\mu B_{o}}{L_{w}\sqrt{k_{y}k_{z}}}(S_{z}+S_{m})$$
    </div>
    
    <p>During this period, if we plot pressure vs. the square root of time, we get a straight line. The slope gives us information about \(k_y\), the permeability perpendicular to the well.</p>
    
    <h3>3. Late Intermediate Time: Radial Flow in the Reservoir Plane</h3>
    
    <p>Eventually, the pressure disturbance has traveled far enough that the well begins to act like a point source in the horizontal plane. Flow becomes radial again, but now in the x-y plane.</p>
    
    <div class="formula-block">
        $$p_{i}-p_{wf}=\frac{162.6q\mu B_{o}}{\sqrt{k_{x}k_{y}}h_{z}}\left[\log_{10}\left(\frac{k_{x}t}{\phi\mu c_{t}L_{w}^{2}}\right)-2.023\right]+\frac{141.2q\mu B_{o}}{L_{w}\sqrt{k_{y}k_{z}}}(S_{z}+S_{m})$$
    </div>
    
    <p>A semilog plot during this period gives us information about the geometric mean of permeabilities in the horizontal plane (\(\sqrt{k_x k_y}\)).</p>
    
    <h3>4. Late Time: Linear Flow to Boundaries</h3>
    
    <p>In a bounded reservoir, the pressure disturbance eventually reaches the lateral boundaries. When this happens, flow becomes linear again, but now on a larger scale.</p>
    
    <div class="formula-block">
        $$p_{i}-p_{wf}=\frac{8.128q B_{o}}{h_{x}h_{z}}\sqrt{\frac{\mu t}{k_{y}\phi c_{t}}}+\frac{141.2q\mu B_{o}}{L_{w}\sqrt{k_{y}k_{z}}}(S_{x}+S_{z}+S_{m})$$
    </div>
    
    <p>Again, a plot of pressure vs. square root of time gives a straight line, but with a different slope that contains information about the overall reservoir dimensions.</p>
    
    <h2>The Concept of Pseudoskin</h2>
    
    <p>One of the fascinating aspects of horizontal well analysis is the concept of "pseudoskin." In vertical wells, skin is a dimensionless factor that represents additional pressure drop due to damage or stimulation near the wellbore.</p>
    
    <p>In horizontal wells, we have additional pseudoskin factors that represent the geometric effects of partial penetration:</p>
    
    <div class="formula-block">
        $$S_{z}=\frac{0.07958h_{z}}{r_{w}^{\prime}}[\Psi(\eta_{1})+\Psi(\eta_{2})-\Psi(\eta_{3})-\Psi(\eta_{4})]$$
    </div>
    
    <p>Where \(\Psi(\eta)\) is the Spence function:</p>
    
    <div class="formula-block">
        $$\Psi(\eta)=\sum_{m=1}^{\infty}{\frac{\sin(m\eta)}{m^{2}}}=-\int_{0}^{\eta}\log_{e}\left[2\sin\left({\frac{u}{2}}\right)\right]\mathrm{d}u$$
    </div>
    
    <p>This function might look intimidating, but it's essentially a mathematical tool that helps us account for the three-dimensional nature of flow around a horizontal well.</p>
    
    <h2>Interactive Horizontal Well Pressure Simulator</h2>
    
    <div id="simulator">
        <h3>Horizontal Well Pressure Response Simulator</h3>
        <p>Adjust the parameters below to see how they affect pressure behavior in a horizontal well test.</p>
        
        <div class="slider-container">
            <label for="permeability-ratio">Permeability Ratio (kz/ky): <span id="perm-ratio-value">0.25</span></label><br>
            <input type="range" id="permeability-ratio" class="slider" min="0.01" max="1" step="0.01" value="0.25">
        </div>
        
        <div class="slider-container">
            <label for="well-length">Well Length (L/h): <span id="length-value">5</span></label><br>
            <input type="range" id="well-length" class="slider" min="1" max="20" step="0.5" value="5">
        </div>
        
        <div class="slider-container">
            <label for="well-position">Well Position (z/h): <span id="position-value">0.5</span></label><br>
            <input type="range" id="well-position" class="slider" min="0.1" max="0.9" step="0.05" value="0.5">
        </div>
        
        <div class="slider-container">
            <label for="test-duration">Test Duration (log scale): <span id="duration-value">3</span></label><br>
            <input type="range" id="test-duration" class="slider" min="0" max="5" step="0.1" value="3">
        </div>
        
        <canvas id="pressure-plot" width="800" height="400"></canvas>
        <div>
            <p><strong>Current Flow Regime: </strong><span id="flow-regime">Early Radial Flow</span></p>
        </div>
    </div>
    
    <h2>Analyzing Pressure Buildup Tests</h2>
    
    <p>So far, we've focused on pressure drawdown (when the well is producing). But equally important is pressure buildup analysis, which occurs when a producing well is shut in and pressure recovers.</p>
    
    <p>The beauty of buildup analysis is that it follows similar principles but with superposition in time. The pressure at any moment is the sum of the pressure due to production and the pressure recovery after shut-in:</p>
    
    <div class="formula-block">
        $$p_{i}-p_{ws}=\frac{162.6q\mu B_{o}}{\sqrt{k_{z}k_{y}}L_{w}}\left[\log_{10}\left(\frac{t_{0}+\Delta t}{\Delta t}\right)+\gamma_{1}\right]$$
    </div>
    
    <p>Where \(\Delta t\) is the shut-in time and \(t_0\) is the production time before shut-in.</p>
    
    <p>This leads to the famous "Horner plot" where we graph pressure vs. \(\log_{10}[(t_0 + \Delta t)/\Delta t]\). The slope of this line gives us permeability information, and extrapolating to infinite shut-in time (\(\log_{10}[(t_0 + \Delta t)/\Delta t] = 0\)) gives us the original reservoir pressure.</p>
    
    <h2>Practical Application: A Worked Example</h2>
    
    <div class="example">
        <h3>Example: Analyzing a Horizontal Well Test</h3>
        
        <p>Consider a horizontal well with the following properties:</p>
        <ul>
            <li>Well length (Lw) = 1000 ft</li>
            <li>Formation thickness (hz) = 50 ft</li>
            <li>Porosity (φ) = 0.15</li>
            <li>Viscosity (μ) = 1 cp</li>
            <li>Total compressibility (ct) = 3×10⁻⁶ psi⁻¹</li>
            <li>Flow rate (q) = 500 STB/D</li>
            <li>Formation volume factor (Bo) = 1.2 RB/STB</li>
        </ul>
        
        <p>From a pressure drawdown test, we observe:</p>
        <ul>
            <li>Early-time semilog slope = 87 psi/cycle</li>
            <li>Intermediate-time square root slope = 15 psi/hr½</li>
        </ul>
        
        <p>Step 1: Calculate permeability from early-time data</p>
        <div class="formula-block">
            $$\sqrt{k_y k_z} = \frac{162.6 \times 500 \times 1 \times 1.2}{87 \times 1000} = 1.12 \text{ md}$$
        </div>
        
        <p>Step 2: Calculate permeability from intermediate-time data</p>
        <div class="formula-block">
            $$k_y = \left(\frac{8.128 \times 500 \times 1.2 \times 1}{15 \times 1000 \times 50}\right)^2 = 1.27 \text{ md}$$
        </div>
        
        <p>Step 3: Determine individual permeabilities</p>
        <div class="formula-block">
            $$k_z = \frac{(\sqrt{k_y k_z})^2}{k_y} = \frac{1.12^2}{1.27} = 0.99 \text{ md}$$
        </div>
        
        <p>This example shows how we can determine directional permeabilities from the different flow regimes, which is one of the key advantages of horizontal well testing.</p>
    </div>
    
    <h2>The Elegance of the Mathematical Solution</h2>
    
    <p>The approach used by Goode and Thambynayagam to solve the diffusion equation is a beautiful example of applied mathematics. They used successive integral transforms:</p>
    
    <ol>
        <li>First, they applied a Fourier cosine transform to the x-coordinate</li>
        <li>Then, they applied another Fourier cosine transform to the z-coordinate</li>
        <li>Finally, they applied a Laplace transform to the time variable</li>
    </ol>
    
    <p>This transformed the partial differential equation into an ordinary differential equation that could be solved analytically. The solution was then inverted back to the original variables.</p>
    
    <p>While the mathematics is complex, the physical interpretation is intuitive: pressure disturbances propagate through the reservoir at rates determined by the rock and fluid properties, creating different flow patterns at different times.</p>
    
    <h2>Practical Implications: When to Expect Each Flow Regime</h2>
    
    <p>One of the most useful aspects of this analysis is that we can predict when each flow regime will occur. The paper provides approximate formulas:</p>
    
    <div class="formula-block">
        $$t_{erf1}=\frac{190.0h_{s}^{2.095}r_{w}^{-0.095}\phi\mu c_{t}}{k_{z}}$$
        $$t_{elf1}=\frac{20.8\phi\mu c_{t}L_{w}^{2}}{k_{x}}$$
        $$t_{brf2}=\frac{1230.0L_{w}^{2}\phi\mu c_{t}}{k_{x}}$$
        $$t_{erf2}=297.0\frac{(L_{x l}+L_{x d})^{2.095}L_{w}^{-0.095}\phi\mu c_{t}}{k_{x}}$$
    </div>
    
    <p>These formulas are invaluable for test design. They tell us how long we need to run a test to see each flow regime, which helps us plan efficient well tests that capture the information we need without wasting time and resources.</p>
    
    <h2>Conclusion: The Power of First Principles</h2>
    
    <p>What makes the analysis of horizontal wells so fascinating is that by starting from first principles—the basic physics of fluid flow in porous media—we can derive powerful tools for reservoir characterization.</p>
    
    <p>The different flow regimes that develop during a pressure test each tell us something different about the reservoir:</p>
    
    <ul>
        <li>Early radial flow tells us about the geometric mean of vertical and horizontal permeabilities</li>
        <li>Intermediate linear flow gives us information about horizontal permeability perpendicular to the well</li>
        <li>Late intermediate radial flow reveals the geometric mean of permeabilities in the horizontal plane</li>
        <li>Late linear flow provides information about reservoir boundaries</li>
    </ul>
    
    <p>By understanding these flow regimes and their mathematical descriptions, engineers can extract a wealth of information from pressure tests, leading to better reservoir management and ultimately more efficient oil and gas production.</p>
    
    <p>The next time you look at a pressure test from a horizontal well, I hope you'll see beyond the curves and equations to the fascinating physics that governs fluid flow in these complex systems.</p>
    
    <script>
        // Interactive simulation code
        const canvas = document.getElementById('pressure-plot');
        const ctx = canvas.getContext('2d');
        const permRatioSlider = document.getElementById('permeability-ratio');
        const wellLengthSlider = document.getElementById('well-length');
        const wellPositionSlider = document.getElementById('well-position');
        const testDurationSlider = document.getElementById('test-duration');
        const permRatioValue = document.getElementById('perm-ratio-value');
        const lengthValue = document.getElementById('length-value');
        const positionValue = document.getElementById('position-value');
        const durationValue = document.getElementById('duration-value');
        const flowRegimeText = document.getElementById('flow-regime');
        
        // Initial values
        let permRatio = 0.25;
        let wellLength = 5;
        let wellPosition = 0.5;
        let testDuration = 3;
        
        // Update values when sliders change
        permRatioSlider.oninput = function() {
            permRatio = parseFloat(this.value);
            permRatioValue.textContent = permRatio.toFixed(2);
            drawPressureCurve();
        };
        
        wellLengthSlider.oninput = function() {
            wellLength = parseFloat(this.value);
            lengthValue.textContent = wellLength.toFixed(1);
            drawPressureCurve();
        };
        
        wellPositionSlider.oninput = function() {
            wellPosition = parseFloat(this.value);
            positionValue.textContent = wellPosition.toFixed(2);
            drawPressureCurve();
        };
        
        testDurationSlider.oninput = function() {
            testDuration = parseFloat(this.value);
            durationValue.textContent = testDuration.toFixed(1);
            drawPressureCurve();
        };
        
        function drawPressureCurve() {
            // Clear canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Draw axes
            ctx.beginPath();
            ctx.moveTo(50, 50);
            ctx.lineTo(50, 350);
            ctx.lineTo(750, 350);
            ctx.strokeStyle = '#000';
            ctx.lineWidth = 2;
            ctx.stroke();
            
            // Label axes
            ctx.font = '14px Arial';
            ctx.fillStyle = '#000';
            ctx.fillText('Time (log scale)', 375, 380);
            ctx.save();
            ctx.translate(20, 200);
            ctx.rotate(-Math.PI/2);
            ctx.fillText('Pressure Drop', 0, 0);
            ctx.restore();
            
            // Calculate transition times based on parameters
            const t1 = 0.2 * (1/permRatio); // End of early radial flow
            const t2 = 0.5 * wellLength * wellLength; // End of intermediate linear flow
            const t3 = 2 * wellLength * wellLength; // End of late intermediate radial flow
            
            // Draw pressure curve
            ctx.beginPath();
            ctx.moveTo(50, 350);
            
            for (let x = 0; x < 700; x++) {
                const logTime = (x / 700) * testDuration;
                const time = Math.pow(10, logTime);
                
                let pressureDrop = 0;
                let flowRegime = "";
                
                if (time < t1) {
                    // Early radial flow
                    pressureDrop = 50 * Math.log10(time + 0.1) + 50;
                    flowRegime = "Early Radial Flow";
                } else if (time < t2) {
                    // Intermediate linear flow
                    pressureDrop = 30 * Math.sqrt(time) + 80;
                    flowRegime = "Intermediate Linear Flow";
                } else if (time < t3) {
                    // Late intermediate radial flow
                    pressureDrop = 40 * Math.log10(time) + 100;
                    flowRegime = "Late Intermediate Radial Flow";
                } else {
                    // Late linear flow
                    pressureDrop = 20 * Math.sqrt(time) + 150;
                    flowRegime = "Late Linear Flow";
                }
                
                // Adjust for parameters
                pressureDrop *= (1 + (1-permRatio)/2); // Permeability effect
                pressureDrop *= (1 + (wellLength-5)/10); // Length effect
                pressureDrop *= (1 + Math.abs(wellPosition-0.5)); // Position effect
                
                // Scale to canvas
                const y = 350 - pressureDrop;
                
                ctx.lineTo(50 + x, y);
                
                // Update flow regime text for current time
                if (logTime >= testDuration * 0.9) {
                    flowRegimeText.textContent = flowRegime;
                }
            }
            
            ctx.strokeStyle = '#3498db';
            ctx.lineWidth = 3;
            ctx.stroke();
            
            // Mark transition points
            const markTransition = (t, color, label) => {
                if (t > 0 && t < Math.pow(10, testDuration)) {
                    const x = 50 + 700 * (Math.log10(t) / testDuration);
                    ctx.beginPath();
                    ctx.arc(x, 100, 5, 0, 2 * Math.PI);
                    ctx.fillStyle = color;
                    ctx.fill();
                    ctx.fillText(label, x - 20, 85);
                }
            };
            
            markTransition(t1, '#e74c3c', 'T1');
            markTransition(t2, '#2ecc71', 'T2');
            markTransition(t3, '#f39c12', 'T3');
        }
        
        // Initial draw
        drawPressureCurve();
    </script>
</body>
</html>