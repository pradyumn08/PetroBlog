<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Understanding Deep Bed Filtration: A First Principles Approach</title>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        h1, h2, h3 {
            color: #2c3e50;
        }
        h1 {
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
        }
        h2 {
            margin-top: 30px;
            border-bottom: 1px solid #ddd;
            padding-bottom: 5px;
        }
        p {
            margin-bottom: 20px;
        }
        .key-concept {
            background-color: #f8f9fa;
            border-left: 4px solid #3498db;
            padding: 15px;
            margin: 20px 0;
        }
        .example {
            background-color: #e8f4f8;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
        }
        .analogy {
            background-color: #f0f5e9;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
        }
        .interactive {
            background-color: #f9f2f4;
            padding: 20px;
            border-radius: 5px;
            margin: 30px 0;
        }
        canvas {
            border: 1px solid #ddd;
            display: block;
            margin: 0 auto;
        }
        .slider-container {
            margin: 20px 0;
        }
        .slider-container label {
            display: inline-block;
            width: 150px;
        }
        .formula {
            margin: 20px 0;
            overflow-x: auto;
        }
        .citation {
            font-size: 0.9em;
            color: #7f8c8d;
        }
        .conclusion {
            background-color: #f5eef8;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
        }
        img {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 20px auto;
        }
    </style>
</head>
<body>
    <h1>Understanding Deep Bed Filtration: From Microscopic to Macroscopic Models</h1>
    
    <p>When you turn on your water faucet, you expect clean, clear water to flow out. But how does water get filtered as it travels through the ground? Or when engineers inject water into oil reservoirs, how do particles in that water interact with the rock? Today, we're going to break down the fascinating process of <strong>deep bed filtration</strong> â€“ a phenomenon that's crucial in water purification, oil extraction, and environmental protection.</p>
    
    <div class="key-concept">
        <h3>What is Deep Bed Filtration?</h3>
        <p>Deep bed filtration is the process where suspended particles in a fluid are captured as they flow through a porous medium (like sand, rock, or a filter). Unlike surface filtration (think of a coffee filter), particles are trapped throughout the entire depth of the medium.</p>
    </div>
    
    <h2>Why Traditional Models Fall Short</h2>
    
    <p>For decades, scientists have used a classical model to describe deep bed filtration. This model assumes that particles move at the same speed as the water carrying them, and are captured at a rate proportional to their flux. But real-world observations tell a different story:</p>
    
    <ul>
        <li>Particles sometimes arrive at the outlet before or long after the water that carried them</li>
        <li>The distribution of trapped particles doesn't match what the classical model predicts</li>
        <li>The model doesn't account for the relationship between pore sizes and particle sizes</li>
    </ul>
    
    <p>These discrepancies matter because they affect our ability to predict how filters will perform, how contaminants will spread in groundwater, or how oil well productivity will decline due to particle buildup.</p>
    
    <h2>First Principles: A Microscopic View of Filtration</h2>
    
    <p>To build a better model, we need to start from first principles by understanding what happens at the microscopic level. Let's visualize porous media as a network of interconnected channels (pores) of various sizes:</p>
    
    <div class="analogy">
        <h3>The Highway Analogy</h3>
        <p>Imagine water flowing through rock as cars traveling on a complex highway system. The particles suspended in water are like different-sized vehicles:</p>
        <ul>
            <li>Small cars (small particles) can travel on any road</li>
            <li>Medium-sized trucks (medium particles) can only use certain lanes and roads</li>
            <li>Large trucks (large particles) are restricted to major highways and can't enter small roads at all</li>
        </ul>
        <p>Just as traffic patterns depend on the mix of vehicles and available roads, the flow of particles through porous media depends on the distribution of particle sizes and pore sizes.</p>
    </div>
    
    <h2>Key Concepts from the Microscopic Model</h2>
    
    <h3>1. Pore Accessibility</h3>
    
    <p>Not all pores are accessible to all particles. A particle with radius \(r_s\) cannot enter a pore with radius \(r_p\) if \(r_s > r_p\). Even in larger pores, particles can't approach the wall closer than their radius.</p>
    
    <p>The accessibility factor \(\chi\) for a spherical particle in a cylindrical pore is given by:</p>
    
    <div class="formula">
        $$\chi(j) = \begin{cases} 
        0, & j > 1 \\
        (1-j)^2, & j < 1
        \end{cases}$$
    </div>
    
    <p>where \(j = r_s/r_p\) is the jamming ratio.</p>
    
    <h3>2. Flux Reduction</h3>
    
    <p>Particles can only flow through the accessible portion of pores. For a spherical particle in a cylindrical pore, the flux reduction factor \(\nu\) is:</p>
    
    <div class="formula">
        $$\nu(j) = \begin{cases} 
        0, & j > 1 \\
        (1-j)^2(1+2j-j^2), & j < 1
        \end{cases}$$
    </div>
    
    <h3>3. Particle Capture Mechanisms</h3>
    
    <p>Particles can be captured by two main mechanisms:</p>
    <ul>
        <li><strong>Size exclusion (straining)</strong>: Particles are physically too large to enter certain pores</li>
        <li><strong>Attachment</strong>: Particles stick to pore walls due to various forces (electric, gravitational, etc.)</li>
    </ul>
    
    <p>The probability of capture combines both mechanisms:</p>
    
    <div class="formula">
        $$p(j) = 1 - \nu(j) + \nu(j)p_a(j)$$
    </div>
    
    <p>where \(p_a\) is the attachment probability.</p>
    
    <div class="interactive">
        <h3>Interactive Simulation: Particle Filtration</h3>
        <p>Adjust the parameters below to see how particles move through a porous medium:</p>
        
        <div class="slider-container">
            <label for="particleSize">Particle Size:</label>
            <input type="range" id="particleSize" min="1" max="10" value="3" step="0.5">
            <span id="particleSizeValue">3</span> units
        </div>
        
        <div class="slider-container">
            <label for="attachProb">Attachment Probability:</label>
            <input type="range" id="attachProb" min="0" max="1" value="0.3" step="0.1">
            <span id="attachProbValue">0.3</span>
        </div>
        
        <div class="slider-container">
            <label for="flowRate">Flow Rate:</label>
            <input type="range" id="flowRate" min="1" max="10" value="5" step="1">
            <span id="flowRateValue">5</span> units/time
        </div>
        
        <canvas id="filtrationCanvas" width="700" height="300"></canvas>
        
        <div>
            <p><strong>Statistics:</strong></p>
            <p>Particles injected: <span id="injectedCount">0</span></p>
            <p>Particles captured: <span id="capturedCount">0</span></p>
            <p>Breakthrough time: <span id="breakthroughTime">N/A</span></p>
        </div>
        
        <script>
document.addEventListener('DOMContentLoaded', function() {
    // Canvas setup
                const canvas = document.getElementById('filtrationCanvas');
                const ctx = canvas.getContext('2d');
                
                // Parameters
                let particleSize = 3;
                let attachmentProbability = 0.3;
                let flowRate = 5;
                
                // Statistics
                let injectedParticles = 0;
                let capturedParticles = 0;
                let breakthroughTime = null;
                let simulationTime = 0;
                
                // Pore structure (array of pore sizes at different x positions)
                const poreStructure = [];
                for (let x = 0; x < canvas.width; x += 20) {
                    const pores = [];
                    for (let i = 0; i < 8; i++) {
                        pores.push(2 + Math.random() * 8); // Random pore sizes between 2 and 10
                    }
                    poreStructure.push(pores);
                }
                
                // Particles
                const particles = [];
                
                // Update parameter displays
                function updateDisplays() {
                    document.getElementById('particleSizeValue').textContent = particleSize;
                    document.getElementById('attachProbValue').textContent = attachmentProbability;
                    document.getElementById('flowRateValue').textContent = flowRate;
                    document.getElementById('injectedCount').textContent = injectedParticles;
                    document.getElementById('capturedCount').textContent = capturedParticles;
                    document.getElementById('breakthroughTime').textContent = 
                        breakthroughTime ? breakthroughTime.toFixed(2) + ' time units' : 'N/A';
                }
                
                // Event listeners for sliders
                document.getElementById('particleSize').addEventListener('input', function() {
                    particleSize = parseFloat(this.value);
                    updateDisplays();
                });
                
                document.getElementById('attachProb').addEventListener('input', function() {
                    attachmentProbability = parseFloat(this.value);
                    updateDisplays();
                });
                
                document.getElementById('flowRate').addEventListener('input', function() {
                    flowRate = parseFloat(this.value);
                    updateDisplays();
                });
                
                // Draw porous medium
                function drawPorousMedium() {
                    ctx.fillStyle = '#f0f0f0';
                    ctx.fillRect(0, 0, canvas.width, canvas.height);
                    
                    ctx.fillStyle = '#a0a0a0';
                    for (let x = 0; x < poreStructure.length; x++) {
                        for (let y = 0; y < canvas.height; y += 40) {
                            const poreIndex = Math.floor(y / 40);
                            if (poreIndex < poreStructure[x].length) {
                                const poreSize = poreStructure[x][poreIndex];
                                // Draw grain (space between pores)
                                ctx.fillRect(x * 20, y, 20, 40 - poreSize * 2);
                            }
                        }
                    }
                }
                
                // Create a new particle
                function createParticle() {
                    const y = 40 * Math.floor(Math.random() * 8) + 20;
                    particles.push({
                        x: 0,
                        y: y,
                        size: particleSize,
                        captured: false,
                        color: `hsl(${Math.random() * 360}, 70%, 60%)`
                    });
                    injectedParticles++;
                }
                
                // Update particle positions
                function updateParticles() {
                    for (let i = particles.length - 1; i >= 0; i--) {
                        const p = particles[i];
                        if (p.captured) continue;
                        
                        // Calculate pore section
                        const xSection = Math.floor(p.x / 20);
                        const ySection = Math.floor(p.y / 40);
                        
                        // Check if particle is within bounds
                        if (xSection >= 0 && xSection < poreStructure.length &&
                            ySection >= 0 && ySection < poreStructure[xSection].length) {
                            
                            const poreSize = poreStructure[xSection][ySection];
                            const j = p.size / poreSize; // Jamming ratio
                            
                            // Size exclusion
                            if (j > 1) {
                                p.captured = true;
                                capturedParticles++;
                                continue;
                            }
                            
                            // Flux reduction
                            const nu = j < 1 ? Math.pow(1-j, 2) * (1 + 2*j - j*j) : 0;
                            
                            // Attachment
                            if (Math.random() < attachmentProbability * nu) {
                                p.captured = true;
                                capturedParticles++;
                                continue;
                            }
                            
                            // Move particle
                            const speed = flowRate * nu;
                            p.x += speed;
                            
                            // Check breakthrough
                            if (p.x >= canvas.width && !breakthroughTime) {
                                breakthroughTime = simulationTime;
                            }
                            
                            // Remove particles that exit
                            if (p.x > canvas.width) {
                                particles.splice(i, 1);
                            }
                        }
                    }
                }
                
                // Draw particles
                function drawParticles() {
                    for (const p of particles) {
                        ctx.fillStyle = p.captured ? '#ff0000' : p.color;
                        ctx.beginPath();
                        ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
                        ctx.fill();
                    }
                }
                
                // Animation loop
                function animate() {
                    ctx.clearRect(0, 0, canvas.width, canvas.height);
                    
                    drawPorousMedium();
                    
                    // Add new particle periodically
                    if (simulationTime % (30 / flowRate) === 0) {
                        createParticle();
                    }
                    
                    updateParticles();
                    drawParticles();
                    
                    simulationTime += 0.1;
                    updateDisplays();
                    
                    requestAnimationFrame(animate);
                }
                
                // Start animation
                animate();
});
</script>
    </div>
    
    <h2>From Microscopic to Macroscopic: The Upscaled Model</h2>
    
    <p>Now that we understand the microscopic behavior, we can derive a macroscopic model that describes the overall process. For a mono-dispersed suspension (particles of the same size), the system of equations becomes:</p>
    
    <div class="formula">
        $$\frac{\partial}{\partial t}[\phi_a(\sigma)c+\sigma] + U\frac{\partial}{\partial x}[cf(\sigma)] = c\frac{\partial \phi_a(\sigma)}{\partial t}$$
    </div>
    
    <div class="formula">
        $$\frac{\partial \sigma}{\partial t} = \frac{1}{l}\frac{k_c(\sigma)}{k(\sigma)}Uc$$
    </div>
    
    <p>Where:</p>
    <ul>
        <li>\(\phi_a\) is the accessible porosity</li>
        <li>\(c\) is the suspended particle concentration</li>
        <li>\(\sigma\) is the retained particle concentration</li>
        <li>\(U\) is the overall flux</li>
        <li>\(f\) is the fractional flow function</li>
        <li>\(k_c\) and \(k\) are permeabilities</li>
        <li>\(l\) is a characteristic length of the porous medium</li>
    </ul>
    
    <p>This system has a <strong>fractional flow form</strong>, similar to equations used in multiphase flow in petroleum engineering. This is a key insight: suspension flow can be viewed as a two-phase flow problem, where the phases are the suspension and particle-free water.</p>
    
    <h2>Explaining Real-World Observations</h2>
    
    <h3>Breakthrough Times</h3>
    
    <p>The breakthrough time (when particles first appear at the outlet) is given by:</p>
    
    <div class="formula">
        $$T_{br} = \frac{s(r_s,0)}{f(r_s,0)}$$
    </div>
    
    <p>Where \(s\) is the "suspension saturation" and \(f\) is the fractional flow. This explains why particles can arrive either before or long after one pore volume of fluid has been injected:</p>
    
    <ul>
        <li>When \(f/s > 1\): Particles move faster than water (early breakthrough)</li>
        <li>When \(f/s < 1\): Particles move slower than water (late breakthrough)</li>
    </ul>
    
    <p>The competition between two effects determines this behavior:</p>
    <ol>
        <li><strong>Velocity enhancement</strong>: Particles can't approach pore walls, so they travel through the center where velocity is higher</li>
        <li><strong>Path tortuosity</strong>: Large particles must take more tortuous paths through the porous medium</li>
    </ol>
    
    <h3>Filtration Function</h3>
    
    <p>The filtration function \(\lambda(\sigma)\) describes how the capture rate changes as more particles are retained. For a two-pore-sized rock, this function is linear (Langmuir kinetics):</p>
    
    <div class="formula">
        $$\lambda(\sigma) = \lambda_0\left(1-\frac{\sigma}{\sigma_{max}}\right)$$
    </div>
    
    <p>But for rocks with three or more pore sizes, the function becomes non-linear, which helps explain why laboratory observations often deviate from classical model predictions.</p>
    
    <h2>Practical Applications</h2>
    
    <p>This enhanced understanding of deep bed filtration has important applications:</p>
    
    <ul>
        <li><strong>Water treatment</strong>: Better design of filters for removing contaminants</li>
        <li><strong>Oil production</strong>: Predicting and mitigating formation damage during water injection</li>
        <li><strong>Environmental protection</strong>: Modeling contaminant transport in groundwater</li>
        <li><strong>Industrial filtration</strong>: Optimizing processes for separating particles from fluids</li>
    </ul>
    
    <div class="conclusion">
        <h3>Key Takeaways</h3>
        <ol>
            <li>Deep bed filtration is more complex than traditional models suggest</li>
            <li>Particle movement depends on both particle size and pore size distributions</li>
            <li>The fractional flow approach provides a more accurate description of the process</li>
            <li>Particles can move faster or slower than the carrying fluid, explaining varied breakthrough times</li>
            <li>The filtration function shape depends on the pore size distribution</li>
        </ol>
    </div>
    
    <p>By understanding deep bed filtration from first principles, we can better predict and control how particles move through porous media, leading to improved technologies for water treatment, oil production, and environmental protection.</p>
    
    <div class="citation">
        <p>Based on the academic paper: "Transport of Particle Suspensions in Porous Media: Fractional Flow Model and Experimental Studies"</p>
    </div>
</body>
</html>