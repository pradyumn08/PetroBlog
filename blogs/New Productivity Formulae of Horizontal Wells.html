<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Understanding Horizontal Well Productivity: A First Principles Approach</title>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        h1, h2, h3 {
            color: #2c3e50;
        }
        h1 {
            font-size: 2.2em;
            margin-bottom: 0.5em;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
        }
        h2 {
            font-size: 1.8em;
            margin-top: 1.5em;
        }
        h3 {
            font-size: 1.4em;
            margin-top: 1.2em;
        }
        p {
            margin-bottom: 1.2em;
        }
        .highlight {
            background-color: #f8f9fa;
            padding: 15px;
            border-left: 4px solid #3498db;
            margin-bottom: 20px;
        }
        .interactive-container {
            background-color: #f5f7fa;
            padding: 20px;
            border-radius: 8px;
            margin: 30px 0;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .controls {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 20px;
        }
        .control-group {
            flex: 1;
            min-width: 200px;
        }
        .slider-container {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        input[type="range"] {
            width: 100%;
        }
        .output {
            font-weight: bold;
            margin-top: 5px;
        }
        canvas {
            width: 100%;
            max-height: 400px;
            margin-top: 20px;
        }
        .note {
            background-color: #fef9e7;
            padding: 10px;
            border-left: 4px solid #f1c40f;
            margin: 20px 0;
        }
        .formula-box {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            margin: 20px 0;
        }
        .comparison {
            display: flex;
            gap: 20px;
            margin: 30px 0;
        }
        .comparison-col {
            flex: 1;
            padding: 15px;
            background-color: #f5f7fa;
            border-radius: 5px;
        }
        img {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 20px auto;
        }
        .button {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }
        .button:hover {
            background-color: #2980b9;
        }
        .tabs {
            display: flex;
            margin-bottom: 20px;
        }
        .tab {
            padding: 10px 20px;
            background-color: #f1f1f1;
            cursor: pointer;
            border: 1px solid #ddd;
            border-bottom: none;
            border-radius: 5px 5px 0 0;
        }
        .tab.active {
            background-color: #3498db;
            color: white;
        }
        .tab-content {
            display: none;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 0 0 5px 5px;
        }
        .tab-content.active {
            display: block;
        }
    </style>
</head>
<body>
    <header>
        <h1>Understanding Horizontal Well Productivity: A First Principles Approach</h1>
        <p class="author">Published: August 10, 2023 | Author: Dr. Reservoir Engineer</p>
    </header>

    <section class="intro">
        <p>Horizontal wells have revolutionized the oil and gas industry by dramatically increasing production rates compared to traditional vertical wells. But how exactly do they work, and more importantly, how can we accurately predict their productivity?</p>
        
        <p>In this post, we'll break down the complex mathematics from J. Lu's paper "New Productivity Formulae of Horizontal Wells" into understandable concepts, starting from first principles. By the end, you'll not only understand the theory but also be able to experiment with an interactive model to see how different parameters affect well productivity.</p>
        
        <div class="highlight">
            <p><strong>Key Insight:</strong> The productivity of a horizontal well can be several times greater than a vertical well draining the same reservoir volume. This is because horizontal wells create an ellipsoidal flow pattern that accesses more of the reservoir, rather than the cylindrical flow pattern of vertical wells.</p>
        </div>
    </section>

    <section>
        <h2>Why Horizontal Wells Matter</h2>
        
        <p>Before diving into the mathematics, let's understand why horizontal wells are so important:</p>
        
        <ul>
            <li><strong>Increased productivity</strong> - access more reservoir area with a single well</li>
            <li><strong>Improved sweep efficiency</strong> - better contact with the reservoir</li>
            <li><strong>Reduced coning</strong> - less water or gas breakthrough</li>
            <li><strong>Increased drainage area</strong> - reach more of the reservoir</li>
        </ul>
        
        <p>Horizontal wells are particularly effective in:</p>
        <ul>
            <li>Thin reservoirs (where vertical wells would have limited contact)</li>
            <li>Naturally fractured reservoirs (intersecting more fractures)</li>
            <li>Reservoirs with water or gas coning problems</li>
            <li>Formations with favorable vertical permeability anisotropy</li>
        </ul>
    </section>

    <section>
        <h2>The Fundamental Principles</h2>
        
        <p>To understand horizontal well productivity, we need to start with the basic physics of fluid flow in porous media. The foundation is Darcy's Law, which describes how fluids move through porous materials like reservoir rock.</p>
        
        <div class="formula-box">
            <p>Darcy's Law in vector form:</p>
            <p>\[ \vec{\nu} = -\frac{K}{\mu}\nabla\Phi \]</p>
            <p>Where:</p>
            <ul>
                <li>\(\vec{\nu}\) is the fluid velocity vector</li>
                <li>\(K\) is the permeability</li>
                <li>\(\mu\) is the fluid viscosity</li>
                <li>\(\nabla\Phi\) is the gradient of the fluid potential</li>
            </ul>
        </div>
        
        <p>In steady state flow, we also have the continuity equation:</p>
        
        <div class="formula-box">
            <p>\[ \text{div}(\vec{\nu}) = 0 \]</p>
            <p>Substituting Darcy's Law:</p>
            <p>\[ \text{div}\left(-\frac{K}{\mu}\nabla\Phi\right) = 0 \]</p>
        </div>
        
        <p>To simplify, we can define a velocity potential:</p>
        
        <div class="formula-box">
            <p>\[ \Phi_{\nu} = \frac{K}{\mu}\Phi \]</p>
            <p>The units of \(\Phi_{\nu}\) are \(\text{m}^2/\text{s}\)</p>
        </div>
        
        <p>This transforms our problem into solving the Laplace equation, which is the foundation of potential flow theory:</p>
        
        <div class="formula-box">
            <p>\[ \nabla^2\Phi_{\nu} = 0 \]</p>
        </div>
        
        <p>Think of this as similar to how we analyze electrical circuits or heat flow - we're looking at how the "potential" (in this case, pressure) distributes through the system.</p>
    </section>

    <section>
        <h2>The 3D Horizontal Well Model</h2>
        
        <p>Previous approaches to horizontal well productivity often used 2D approximations. The key innovation in Lu's paper is using a full 3D model, which more accurately captures the complex flow patterns around a horizontal well.</p>
        
        <p>Here are the key assumptions of the model:</p>
        
        <ol>
            <li>The reservoir is horizontal, homogeneous, and anisotropic (different permeabilities in different directions)</li>
            <li>The reservoir pressure is initially constant throughout</li>
            <li>The well is represented as a uniform line source</li>
            <li>A single-phase fluid flows at a constant rate</li>
        </ol>
        
        <p>The horizontal well is modeled as a line segment of length \(L\) located at a distance \(z_w\) from the lower boundary of the reservoir, which has a total thickness \(H\).</p>
        
        <div class="note">
            <p><strong>Key Insight:</strong> Unlike vertical wells that create radial flow patterns, horizontal wells create ellipsoidal flow patterns. This fundamentally changes how we must approach the mathematics.</p>
        </div>
    </section>

    <section>
        <h2>Deriving the Velocity Potential</h2>
        
        <p>To find the velocity potential at any point in the reservoir, we need to integrate the effect of each small segment of the horizontal well. This is where the mathematics gets interesting.</p>
        
        <p>For a point source in 3D space, the velocity potential is:</p>
        
        <div class="formula-box">
            <p>\[ \Phi_{\nu} = -\frac{q}{4\pi r} + \text{constant} \]</p>
            <p>Where \(r\) is the distance from the point source.</p>
        </div>
        
        <p>For a horizontal well of length \(L\) with its midpoint at the origin, the velocity potential at any point \(C(x_0, y_0, z_0)\) is found by integrating along the well:</p>
        
        <div class="formula-box">
            <p>\[ \Phi_{\nu} = -\frac{Q}{4\pi L}\int_{-L/2}^{L/2}\frac{dx}{R(x)} \]</p>
            <p>Where:</p>
            <p>\[ R(x) = \sqrt{(x-x_0)^2 + r_0^2} \]</p>
            <p>\[ r_0 = \sqrt{y_0^2 + z_0^2} \]</p>
        </div>
        
        <p>After solving this integral (which involves some complex geometry), we get:</p>
        
        <div class="formula-box">
            <p>\[ \Phi_{\nu} = \frac{Q}{4\pi L}\ln\left(\frac{t-L/2}{t+L/2}\right) \]</p>
            <p>Where \(t\) relates to the ellipsoidal geometry of the flow.</p>
        </div>
        
        <p>This is a crucial result: it tells us that the equipotential surfaces around a horizontal well are a family of ellipsoids of revolution whose foci are the two endpoints of the horizontal well.</p>
        
        <div class="note">
            <p><strong>Analogy:</strong> Think of the horizontal well as a long, thin magnet. The magnetic field lines around it form ellipsoidal shapes. The fluid flow pattern around a horizontal well follows similar ellipsoidal paths.</p>
        </div>
    </section>

    <section>
        <h2>The Average Well Potential</h2>
        
        <p>To calculate the productivity of the well, we need to find the average potential along the wellbore. This is done using either:</p>
        
        <ol>
            <li>The pressure-averaging technique (integrating along the well)</li>
            <li>The equivalent-pressure point technique (using representative points)</li>
        </ol>
        
        <p>After mathematical derivation, the average velocity potential of the horizontal wellbore is:</p>
        
        <div class="formula-box">
            <p>\[ \tilde{\Phi}_{\nu} \approx \frac{Q}{4\pi L}\ln\left[\frac{R_w^2}{2L^2}\ln\left(2L/R_w\right)\right] \]</p>
            <p>Where \(R_w\) is the radius of the wellbore.</p>
        </div>
        
        <p>Alternatively, using Simpson's Integral Approximation Rule:</p>
        
        <div class="formula-box">
            <p>\[ \tilde{\Phi}_{\nu} \approx \frac{Q}{4\pi L}\left[\frac{5}{3}\ln(R_w/L) - \frac{1}{3}\ln 2\right] \]</p>
        </div>
        
        <p>These two methods yield similar results, with only about 7% difference between them.</p>
    </section>

    <section>
        <h2>The Final Productivity Formula</h2>
        
        <p>For a horizontal well at the midheight of a formation, the productivity formula is:</p>
        
        <div class="formula-box">
            <p>\[ Q_w = \frac{4\pi K L\Delta P_w/(\mu B)}{\ln\left[\frac{2E L^2}{R_w^2\ln(2L/R_w)}\right]} \]</p>
            <p>Where:</p>
            <ul>
                <li>\(Q_w\) is the well productivity</li>
                <li>\(K\) is the permeability</li>
                <li>\(L\) is the well length</li>
                <li>\(\Delta P_w\) is the pressure drawdown</li>
                <li>\(\mu\) is the fluid viscosity</li>
                <li>\(B\) is the formation volume factor</li>
                <li>\(E = \frac{\sqrt{L^2+H^2}-L}{\sqrt{L^2+H^2}+L}\)</li>
                <li>\(R_w\) is the wellbore radius</li>
                <li>\(H\) is the formation thickness</li>
            </ul>
        </div>
        
        <p>For cases where \(L \gg H\) (the well is much longer than the formation is thick), this simplifies to:</p>
        
        <div class="formula-box">
            <p>\[ Q_w = \frac{4\pi K L\Delta P_w/(\mu B)}{\ln\left[\frac{H^2}{2R_w^2\ln(2L/R_w)}\right]} \]</p>
        </div>
        
        <p>For anisotropic reservoirs (where vertical and horizontal permeabilities differ), we get:</p>
        
        <div class="formula-box">
            <p>\[ Q_w = \frac{4\pi\sqrt[4]{K_v^3}K_h^{1/4}L\Delta P_w/(\mu B)}{\ln\frac{1}{2} + 2F + G - \ln F} \]</p>
            <p>Where:</p>
            <p>\[ F = \ln\left[\frac{4L}{(\beta+1)R_w}\right] \]</p>
            <p>\[ G = \ln\left[\frac{\sqrt{K_v L^2 + K_h H^2} - \sqrt{K_v}L}{\sqrt{K_v L^2 + K_h H^2} + \sqrt{K_v}L}\right] \]</p>
            <p>\[ \beta = \sqrt{\frac{K_h}{K_v}} \]</p>
        </div>
        
        <p>These formulas are the heart of Lu's contribution - they accurately predict horizontal well productivity in various reservoir conditions.</p>
    </section>

    <section>
        <h2>Special Cases: Gas Cap and Bottom Water</h2>
        
        <p>Lu's paper also provides formulas for horizontal wells in reservoirs with either a gas cap or bottom water. These are particularly important in practice, as many real reservoirs have these features.</p>
        
        <p>For a well in a reservoir with bottom water (constant pressure at bottom boundary, impermeable top):</p>
        
        <div class="formula-box">
            <p>\[ Q_w = \frac{\alpha_l\pi\sqrt{K_h K_v}L\Delta P_w^l/(\mu B)}{\ln\left[4H_D/(\pi R_{wD})\right] + \ln\left[\tan\left(\frac{\pi z_{wD}}{2H_D}\right)\right]} \]</p>
        </div>
        
        <p>For a well in a reservoir with a gas cap (constant pressure at top boundary, impermeable bottom):</p>
        
        <div class="formula-box">
            <p>\[ Q_w = \frac{\alpha_l\pi\sqrt{K_h K_v}L\Delta P_w^l/(\mu B)}{\ln\left[4H_D/(\pi R_{wD})\right] + \ln\left[\cot\left(\frac{\pi z_{wD}}{2H_D}\right)\right]} \]</p>
        </div>
        
        <p>For a well in a reservoir with both gas cap and bottom water (constant pressure at both boundaries):</p>
        
        <div class="formula-box">
            <p>\[ Q_w = \frac{\alpha_l\pi\sqrt{K_h K_v}L\Delta P_w^l/(\mu B)}{\ln\left\{\frac{\sin(\pi z_{wD}/H_D)}{\sin[\pi R_{wD}/(2H_D)]}\right\}} \]</p>
        </div>
        
        <p>Where \(\alpha_l\) is a parameter that depends on where the pressure is measured (endpoint, midpoint, or average).</p>
    </section>

    <section>
        <h2>Interactive Horizontal Well Simulator</h2>
        
        <div class="interactive-container">
            <h3>Explore Horizontal Well Productivity</h3>
            <p>Adjust the parameters below to see how they affect horizontal well productivity compared to a vertical well.</p>
            
            <div class="tabs">
                <div class="tab active" onclick="switchTab('basic-tab')">Basic Model</div>
                <div class="tab" onclick="switchTab('advanced-tab')">Advanced Model</div>
                <div class="tab" onclick="switchTab('comparison-tab')">Formula Comparison</div>
            </div>
            
            <div id="basic-tab" class="tab-content active">
                <div class="controls">
                    <div class="control-group">
                        <div class="slider-container">
                            <label for="length">Well Length (L): <span id="length-value">300</span> m</label>
                            <input type="range" id="length" min="100" max="1000" value="300" step="50">
                        </div>
                        
                        <div class="slider-container">
                            <label for="thickness">Formation Thickness (H): <span id="thickness-value">50</span> m</label>
                            <input type="range" id="thickness" min="10" max="100" value="50" step="5">
                        </div>
                        
                        <div class="slider-container">
                            <label for="permeability">Permeability (K): <span id="permeability-value">100</span> mD</label>
                            <input type="range" id="permeability" min="1" max="500" value="100" step="10">
                        </div>
                    </div>
                    
                    <div class="control-group">
                        <div class="slider-container">
                            <label for="well-radius">Wellbore Radius (Rw): <span id="well-radius-value">0.1</span> m</label>
                            <input type="range" id="well-radius" min="0.05" max="0.2" value="0.1" step="0.01">
                        </div>
                        
                        <div class="slider-container">
                            <label for="drawdown">Pressure Drawdown (ΔP): <span id="drawdown-value">5</span> MPa</label>
                            <input type="range" id="drawdown" min="1" max="10" value="5" step="0.5">
                        </div>
                        
                        <div class="slider-container">
                            <label for="viscosity">Fluid Viscosity (μ): <span id="viscosity-value">1</span> cP</label>
                            <input type="range" id="viscosity" min="0.1" max="10" value="1" step="0.1">
                        </div>
                    </div>
                </div>
                
                <div class="results">
                    <h4>Results:</h4>
                    <p>Horizontal Well Productivity: <span id="horizontal-productivity">0</span> m³/day</p>
                    <p>Vertical Well Productivity: <span id="vertical-productivity">0</span> m³/day</p>
                    <p>Productivity Ratio (Horizontal/Vertical): <span id="productivity-ratio">0</span></p>
                </div>
                
                <canvas id="productivity-chart"></canvas>
            </div>
            
            <div id="advanced-tab" class="tab-content">
                <div class="controls">
                    <div class="control-group">
                        <div class="slider-container">
                            <label for="kh">Horizontal Permeability (Kh): <span id="kh-value">100</span> mD</label>
                            <input type="range" id="kh" min="1" max="500" value="100" step="10">
                        </div>
                        
                        <div class="slider-container">
                            <label for="kv">Vertical Permeability (Kv): <span id="kv-value">50</span> mD</label>
                            <input type="range" id="kv" min="1" max="500" value="50" step="10">
                        </div>
                        
                        <div class="slider-container">
                            <label for="z-position">Well Position (zw): <span id="z-position-value">25</span> m</label>
                            <input type="range" id="z-position" min="5" max="45" value="25" step="5">
                        </div>
                    </div>
                    
                    <div class="control-group">
                        <div class="slider-container">
                            <label for="adv-length">Well Length (L): <span id="adv-length-value">300</span> m</label>
                            <input type="range" id="adv-length" min="100" max="1000" value="300" step="50">
                        </div>
                        
                        <div class="slider-container">
                            <label for="adv-thickness">Formation Thickness (H): <span id="adv-thickness-value">50</span> m</label>
                            <input type="range" id="adv-thickness" min="10" max="100" value="50" step="5">
                        </div>
                        
                        <div>
                            <label>Reservoir Type:</label>
                            <select id="reservoir-type">
                                <option value="normal">Normal (No Gas Cap/Bottom Water)</option>
                                <option value="gas-cap">Gas Cap</option>
                                <option value="bottom-water">Bottom Water</option>
                                <option value="both">Both Gas Cap and Bottom Water</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <div class="results">
                    <h4>Advanced Results:</h4>
                    <p>Horizontal Well Productivity (Lu's Formula): <span id="adv-horizontal-productivity">0</span> m³/day</p>
                    <p>Anisotropy Factor (β): <span id="anisotropy-factor">0</span></p>
                    <p>Effective Permeability: <span id="effective-permeability">0</span> mD</p>
                </div>
                
                <canvas id="advanced-chart"></canvas>
            </div>
            
            <div id="comparison-tab" class="tab-content">
                <p>Compare different horizontal well productivity formulas using the same parameters:</p>
                
                <div class="controls">
                    <div class="control-group">
                        <div class="slider-container">
                            <label for="comp-length">Well Length (L): <span id="comp-length-value">300</span> m</label>
                            <input type="range" id="comp-length" min="100" max="1000" value="300" step="50">
                        </div>
                        
                        <div class="slider-container">
                            <label for="comp-thickness">Formation Thickness (H): <span id="comp-thickness-value">50</span> m</label>
                            <input type="range" id="comp-thickness" min="10" max="100" value="50" step="5">
                        </div>
                    </div>
                    
                    <div class="control-group">
                        <div class="slider-container">
                            <label for="comp-kh">Horizontal Permeability (Kh): <span id="comp-kh-value">100</span> mD</label>
                            <input type="range" id="comp-kh" min="1" max="500" value="100" step="10">
                        </div>
                        
                        <div class="slider-container">
                            <label for="comp-kv">Vertical Permeability (Kv): <span id="comp-kv-value">50</span> mD</label>
                            <input type="range" id="comp-kv" min="1" max="500" value="50" step="10">
                        </div>
                    </div>
                </div>
                
                <canvas id="comparison-chart"></canvas>
                
                <div class="note">
                    <p><strong>Note:</strong> Lu's 3D formula generally predicts higher productivity than earlier 2D models, which is more consistent with field observations. This demonstrates the importance of properly accounting for the 3D flow pattern around horizontal wells.</p>
                </div>
            </div>
        </div>
    </section>

    <section>
        <h2>Real-World Application: Liu-Hua Reservoir Case Study</h2>
        
        <p>Lu's paper applied the new formulas to a real horizontal well in the Liu-Hua Reservoir in the South China Sea. Let's examine the results:</p>
        
        <div class="highlight">
            <p><strong>Reservoir Properties:</strong></p>
            <ul>
                <li>Horizontal well length: 600 m</li>
                <li>Drainage radius: 500 m</li>
                <li>Wellbore radius: 0.1098 m</li>
                <li>Horizontal permeability: 569 mD</li>
                <li>Vertical permeability: 280 mD</li>
                <li>Formation thickness: 63 m</li>
                <li>Oil viscosity: 65 mPa·s</li>
                <li>Distance to bottom water: 56.86 m</li>
            </ul>
        </div>
        
        <p>When compared with actual field data, Lu's 3D formulas predicted productivity values much closer to reality than previous 2D models:</p>
        
        <table border="1" style="width:100%; border-collapse: collapse; margin: 20px 0;">
            <tr style="background-color: #f2f2f2;">
                <th style="padding: 10px; text-align: left;">Formula</th>
                <th style="padding: 10px; text-align: center;">Predicted Productivity at ΔP = 4.57 MPa (m³/day)</th>
                <th style="padding: 10px; text-align: center;">Predicted Productivity at ΔP = 5.90 MPa (m³/day)</th>
            </tr>
            <tr>
                <td style="padding: 10px;">Borisov's Formula</td>
                <td style="padding: 10px; text-align: center;">555</td>
                <td style="padding: 10px; text-align: center;">716</td>
            </tr>
            <tr>
                <td style="padding: 10px;">Giger's Formula</td>
                <td style="padding: 10px; text-align: center;">592</td>
                <td style="padding: 10px; text-align: center;">764</td>
            </tr>
            <tr>
                <td style="padding: 10px;">Joshi's Formula</td>
                <td style="padding: 10px; text-align: center;">630</td>
                <td style="padding: 10px; text-align: center;">813</td>
            </tr>
            <tr>
                <td style="padding: 10px;">Renard's Formula</td>
                <td style="padding: 10px; text-align: center;">694</td>
                <td style="padding: 10px; text-align: center;">898</td>
            </tr>
            <tr style="background-color: #e6f7ff;">
                <td style="padding: 10px;">Lu's Formula (midheight)</td>
                <td style="padding: 10px; text-align: center;">1,468</td>
                <td style="padding: 10px; text-align: center;">1,896</td>
            </tr>
            <tr style="background-color: #e6f7ff;">
                <td style="padding: 10px;">Lu's Formula (eccentric)</td>
                <td style="padding: 10px; text-align: center;">1,294</td>
                <td style="padding: 10px; text-align: center;">1,568</td>
            </tr>
            <tr style="font-weight: bold; background-color: #f2f2f2;">
                <td style="padding: 10px;">Actual Field Productivity</td>
                <td style="padding: 10px; text-align: center;">1,288</td>
                <td style="padding: 10px; text-align: center;">1,516</td>
            </tr>
        </table>
        
        <p>The results clearly show that Lu's 3D formulas provide much more accurate predictions than previous 2D models. This is especially important for economic evaluations of horizontal drilling projects.</p>
    </section>

    <section>
        <h2>Key Takeaways</h2>
        
        <ol>
            <li><strong>3D vs. 2D modeling:</strong> The 3D approach captures the ellipsoidal flow pattern around horizontal wells much more accurately than previous 2D models.</li>
            <li><strong>Equipotential surfaces:</strong> The equipotential surfaces around a horizontal well are ellipsoids of revolution with foci at the well endpoints.</li>
            <li><strong>Anisotropy matters:</strong> The difference between horizontal and vertical permeability significantly affects productivity and must be properly accounted for.</li>
            <li><strong>Well position:</strong> The position of the well relative to reservoir boundaries (especially in cases with gas cap or bottom water) is crucial for accurate productivity prediction.</li>
            <li><strong>Practical accuracy:</strong> The new formulas predict productivity values much closer to field observations than previous models.</li>
        </ol>
        
        <div class="highlight">
            <p><strong>Bottom Line:</strong> Horizontal wells create fundamentally different flow patterns than vertical wells. By properly modeling these 3D ellipsoidal flow patterns, we can more accurately predict productivity and make better economic decisions about horizontal drilling projects.</p>
        </div>
    </section>

    <script>
        // Basic tab functionality
        function switchTab(tabId) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Deactivate all tabs
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Activate the selected tab and content
            document.getElementById(tabId).classList.add('active');
            document.querySelector(`.tab[onclick="switchTab('${tabId}')"]`).classList.add('active');
        }
        
        // Initialize charts
        let productivityChart, advancedChart, comparisonChart;
        
        // Basic model calculations
        function calculateBasicProductivity() {
            const length = parseFloat(document.getElementById('length').value);
            const thickness = parseFloat(document.getElementById('thickness').value);
            const permeability = parseFloat(document.getElementById('permeability').value);
            const wellRadius = parseFloat(document.getElementById('well-radius').value);
            const drawdown = parseFloat(document.getElementById('drawdown').value);
            const viscosity = parseFloat(document.getElementById('viscosity').value);
            
            // Convert mD to m²
            const k = permeability * 9.869233e-16;
            
            // Simplified Lu's formula for horizontal well
            const E = (Math.sqrt(length*length + thickness*thickness) - length) / 
                      (Math.sqrt(length*length + thickness*thickness) + length);
            
            const horizontalProductivity = (4 * Math.PI * k * length * drawdown * 1e6) / 
                                         (viscosity * 1e-3 * Math.log(2 * E * length*length / 
                                          (wellRadius*wellRadius * Math.log(2*length/wellRadius))));
            
            // Convert to m³/day
            const horizontalProductivityDay = horizontalProductivity * 86400;
            
            // Simplified formula for vertical well
            const drainageRadius = 0.5 * Math.sqrt(length*length + thickness*thickness);
            const verticalProductivity = (2 * Math.PI * k * thickness * drawdown * 1e6) / 
                                       (viscosity * 1e-3 * Math.log(drainageRadius/wellRadius));
            
            // Convert to m³/day
            const verticalProductivityDay = verticalProductivity * 86400;
            
            // Update the display
            document.getElementById('horizontal-productivity').textContent = horizontalProductivityDay.toFixed(2);
            document.getElementById('vertical-productivity').textContent = verticalProductivityDay.toFixed(2);
            document.getElementById('productivity-ratio').textContent = (horizontalProductivityDay / verticalProductivityDay).toFixed(2);
            
            // Update the chart
            updateProductivityChart(horizontalProductivityDay, verticalProductivityDay);
        }
        
        // Advanced model calculations
        function calculateAdvancedProductivity() {
            const length = parseFloat(document.getElementById('adv-length').value);
            const thickness = parseFloat(document.getElementById('adv-thickness').value);
            const kh = parseFloat(document.getElementById('kh').value);
            const kv = parseFloat(document.getElementById('kv').value);
            const zPosition = parseFloat(document.getElementById('z-position').value);
            const reservoirType = document.getElementById('reservoir-type').value;
            
            // Convert mD to m²
            const khSI = kh * 9.869233e-16;
            const kvSI = kv * 9.869233e-16;
            
            // Calculate anisotropy factor
            const beta = Math.sqrt(kh/kv);
            const effectiveK = Math.sqrt(kh*kv);
            
            // Dimensionless parameters
            const HD = thickness/length * Math.sqrt(effectiveK/kvSI);
            const zwD = zPosition/length * Math.sqrt(effectiveK/kvSI);
            const RwD = 0.1/length * (beta**0.5 + beta**(-0.5))/2;
            
            let productivity;
            
            // Different formulas based on reservoir type
            if (reservoirType === 'normal') {
                // Midheight formula
                const F = Math.log(4*length/((beta+1)*0.1));
                const G = Math.log((Math.sqrt(kvSI*length*length + khSI*thickness*thickness) - Math.sqrt(kvSI)*length) / 
                                 (Math.sqrt(kvSI*length*length + khSI*thickness*thickness) + Math.sqrt(kvSI)*length));
                
                productivity = (4 * Math.PI * Math.pow(kvSI,0.75) * Math.pow(khSI,0.25) * length * 5e6) / 
                             (1e-3 * (Math.log(0.5) + 2*F + G - Math.log(F)));
            } 
            else if (reservoirType === 'bottom-water') {
                // Bottom water formula
                productivity = (2.4 * Math.PI * Math.sqrt(khSI*kvSI) * length * 5e6) / 
                             (1e-3 * (Math.log(4*HD/(Math.PI*RwD)) + Math.log(Math.tan(Math.PI*zwD/(2*HD)))));
            }
            else if (reservoirType === 'gas-cap') {
                // Gas cap formula
                productivity = (2.4 * Math.PI * Math.sqrt(khSI*kvSI) * length * 5e6) / 
                             (1e-3 * (Math.log(4*HD/(Math.PI*RwD)) + Math.log(1/Math.tan(Math.PI*zwD/(2*HD)))));
            }
            else if (reservoirType === 'both') {
                // Both gas cap and bottom water
                productivity = (2.4 * Math.PI * Math.sqrt(khSI*kvSI) * length * 5e6) / 
                             (1e-3 * Math.log(Math.sin(Math.PI*zwD/HD) / Math.sin(Math.PI*RwD/(2*HD))));
            }
            
            // Convert to m³/day
            const productivityDay = productivity * 86400;
            
            // Update the display
            document.getElementById('adv-horizontal-productivity').textContent = productivityDay.toFixed(2);
            document.getElementById('anisotropy-factor').textContent = beta.toFixed(2);
            document.getElementById('effective-permeability').textContent = effectiveK.toFixed(2);
            
            // Update the chart
            updateAdvancedChart(productivityDay, reservoirType);
        }
        
        // Formula comparison calculations
        function calculateComparisonProductivity() {
            const length = parseFloat(document.getElementById('comp-length').value);
            const thickness = parseFloat(document.getElementById('comp-thickness').value);
            const kh = parseFloat(document.getElementById('comp-kh').value);
            const kv = parseFloat(document.getElementById('comp-kv').value);
            
            // Convert mD to m²
            const khSI = kh * 9.869233e-16;
            const kvSI = kv * 9.869233e-16;
            const k = Math.sqrt(kh*kv) * 9.869233e-16;
            
            // Common parameters
            const wellRadius = 0.1;
            const drawdown = 5e6; // 5 MPa
            const viscosity = 1e-3; // 1 cP
            const drainageRadius = 500;
            const beta = Math.sqrt(kh/kv);
            
            // Borisov's formula
            const borisovProductivity = (2 * Math.PI * khSI * thickness * drawdown) / 
                                      (viscosity * (Math.log(4*drainageRadius/length) + 
                                       (thickness/length) * Math.log(thickness/(2*Math.PI*wellRadius))));
            
            // Giger's formula
            const a_giger = length/2 * Math.sqrt(0.5 + Math.sqrt(0.25 + Math.pow(2*drainageRadius/length, 4)));
            const gigerProductivity = (2 * Math.PI * khSI * thickness * drawdown) / 
                                    (viscosity * ((length/thickness) * 
                                     Math.log((1 + Math.sqrt(1 - Math.pow(length/(2*drainageRadius), 2))) / 
                                     (length/(2*drainageRadius))) + 
                                     Math.log(thickness/(2*Math.PI*wellRadius))));
            
            // Joshi's formula
            const a_joshi = (length/2) * Math.sqrt(0.5 + Math.sqrt(0.25 + Math.pow(2*drainageRadius/length, 4)));
            const joshiProductivity = (2 * Math.PI * khSI * thickness * drawdown) / 
                                    (viscosity * (Math.log((2*a_joshi + Math.sqrt(4*a_joshi*a_joshi - length*length)) / length) + 
                                     (beta*thickness/length) * Math.log(beta*thickness/(2*wellRadius))));
            
            // Lu's 3D formula
            const E = (Math.sqrt(length*length + thickness*thickness) - length) / 
                      (Math.sqrt(length*length + thickness*thickness) + length);
            
            const luProductivity = (4 * Math.PI * k * length * drawdown) / 
                                 (viscosity * Math.log(2 * E * length*length / 
                                  (wellRadius*wellRadius * Math.log(2*length/wellRadius))));
            
            // Convert to m³/day
            const borisovProductivityDay = borisovProductivity * 86400;
            const gigerProductivityDay = gigerProductivity * 86400;
            const joshiProductivityDay = joshiProductivity * 86400;
            const luProductivityDay = luProductivity * 86400;
            
            // Update the chart
            updateComparisonChart(borisovProductivityDay, gigerProductivityDay, joshiProductivityDay, luProductivityDay);
        }
        
        // Chart updates
        function updateProductivityChart(horizontalProductivity, verticalProductivity) {
            if (productivityChart) {
                productivityChart.destroy();
            }
            
            const ctx = document.getElementById('productivity-chart').getContext('2d');
            productivityChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Horizontal Well', 'Vertical Well'],
                    datasets: [{
                        label: 'Productivity (m³/day)',
                        data: [horizontalProductivity, verticalProductivity],
                        backgroundColor: [
                            'rgba(54, 162, 235, 0.7)',
                            'rgba(255, 99, 132, 0.7)'
                        ],
                        borderColor: [
                            'rgba(54, 162, 235, 1)',
                            'rgba(255, 99, 132, 1)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Productivity (m³/day)'
                            }
                        }
                    }
                }
            });
        }
        
        function updateAdvancedChart(productivity, reservoirType) {
            if (advancedChart) {
                advancedChart.destroy();
            }
            
            // Create data for different well positions
            const positions = [];
            const productivities = [];
            
            const length = parseFloat(document.getElementById('adv-length').value);
            const thickness = parseFloat(document.getElementById('adv-thickness').value);
            const kh = parseFloat(document.getElementById('kh').value);
            const kv = parseFloat(document.getElementById('kv').value);
            
            // Convert mD to m²
            const khSI = kh * 9.869233e-16;
            const kvSI = kv * 9.869233e-16;
            
            // Calculate anisotropy factor
            const beta = Math.sqrt(kh/kv);
            const effectiveK = Math.sqrt(kh*kv);
            
            for (let zPos = 5; zPos <= thickness-5; zPos += 5) {
                positions.push(zPos);
                
                // Dimensionless parameters
                const HD = thickness/length * Math.sqrt(effectiveK/kvSI);
                const zwD = zPos/length * Math.sqrt(effectiveK/kvSI);
                const RwD = 0.1/length * (beta**0.5 + beta**(-0.5))/2;
                
                let posProductivity;
                
                // Different formulas based on reservoir type
                if (reservoirType === 'normal') {
                    // Midheight formula
                    const F = Math.log(4*length/((beta+1)*0.1));
                    const G = Math.log((Math.sqrt(kvSI*length*length + khSI*thickness*thickness) - Math.sqrt(kvSI)*length) / 
                                     (Math.sqrt(kvSI*length*length + khSI*thickness*thickness) + Math.sqrt(kvSI)*length));
                    
                    posProductivity = (4 * Math.PI * Math.pow(kvSI,0.75) * Math.pow(khSI,0.25) * length * 5e6) / 
                                 (1e-3 * (Math.log(0.5) + 2*F + G - Math.log(F)));
                } 
                else if (reservoirType === 'bottom-water') {
                    // Bottom water formula
                    posProductivity = (2.4 * Math.PI * Math.sqrt(khSI*kvSI) * length * 5e6) / 
                                 (1e-3 * (Math.log(4*HD/(Math.PI*RwD)) + Math.log(Math.tan(Math.PI*zwD/(2*HD)))));
                }
                else if (reservoirType === 'gas-cap') {
                    // Gas cap formula
                    posProductivity = (2.4 * Math.PI * Math.sqrt(khSI*kvSI) * length * 5e6) / 
                                 (1e-3 * (Math.log(4*HD/(Math.PI*RwD)) + Math.log(1/Math.tan(Math.PI*zwD/(2*HD)))));
                }
                else if (reservoirType === 'both') {
                    // Both gas cap and bottom water
                    posProductivity = (2.4 * Math.PI * Math.sqrt(khSI*kvSI) * length * 5e6) / 
                                 (1e-3 * Math.log(Math.sin(Math.PI*zwD/HD) / Math.sin(Math.PI*RwD/(2*HD))));
                }
                
                // Convert to m³/day
                productivities.push(posProductivity * 86400);
            }
            
            const ctx = document.getElementById('advanced-chart').getContext('2d');
            advancedChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: positions,
                    datasets: [{
                        label: 'Productivity vs Well Position',
                        data: productivities,
                        borderColor: 'rgba(75, 192, 192, 1)',
                        backgroundColor: 'rgba(75, 192, 192, 0.2)',
                        tension: 0.1,
                        fill: true
                    }]
                },
                options: {
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'Well Position from Bottom (m)'
                            }
                        },
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Productivity (m³/day)'
                            }
                        }
                    }
                }
            });
        }
        
        function updateComparisonChart(borisov, giger, joshi, lu) {
            if (comparisonChart) {
                comparisonChart.destroy();
            }
            
            const ctx = document.getElementById('comparison-chart').getContext('2d');
            comparisonChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Borisov (1964)', 'Giger (1984)', 'Joshi (1988)', 'Lu (3D Model)'],
                    datasets: [{
                        label: 'Productivity (m³/day)',
                        data: [borisov, giger, joshi, lu],
                        backgroundColor: [
                            'rgba(255, 99, 132, 0.7)',
                            'rgba(255, 159, 64, 0.7)',
                            'rgba(255, 205, 86, 0.7)',
                            'rgba(75, 192, 192, 0.7)'
                        ],
                        borderColor: [
                            'rgba(255, 99, 132, 1)',
                            'rgba(255, 159, 64, 1)',
                            'rgba(255, 205, 86, 1)',
                            'rgba(75, 192, 192, 1)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Productivity (m³/day)'
                            }
                        }
                    }
                }
            });
        }
        
        // Update display values when sliders change
        document.getElementById('length').addEventListener('input', function() {
            document.getElementById('length-value').textContent = this.value;
            calculateBasicProductivity();
        });
        
        document.getElementById('thickness').addEventListener('input', function() {
            document.getElementById('thickness-value').textContent = this.value;
            calculateBasicProductivity();
        });
        
        document.getElementById('permeability').addEventListener('input', function() {
            document.getElementById('permeability-value').textContent = this.value;
            calculateBasicProductivity();
        });
        
        document.getElementById('well-radius').addEventListener('input', function() {
            document.getElementById('well-radius-value').textContent = this.value;
            calculateBasicProductivity();
        });
        
        document.getElementById('drawdown').addEventListener('input', function() {
            document.getElementById('drawdown-value').textContent = this.value;
            calculateBasicProductivity();
        });
        
        document.getElementById('viscosity').addEventListener('input', function() {
            document.getElementById('viscosity-value').textContent = this.value;
            calculateBasicProductivity();
        });
        
        // Advanced tab sliders
        document.getElementById('kh').addEventListener('input', function() {
            document.getElementById('kh-value').textContent = this.value;
            calculateAdvancedProductivity();
        });
        
        document.getElementById('kv').addEventListener('input', function() {
            document.getElementById('kv-value').textContent = this.value;
            calculateAdvancedProductivity();
        });
        
        document.getElementById('z-position').addEventListener('input', function() {
            document.getElementById('z-position-value').textContent = this.value;
            calculateAdvancedProductivity();
        });
        
        document.getElementById('adv-length').addEventListener('input', function() {
            document.getElementById('adv-length-value').textContent = this.value;
            calculateAdvancedProductivity();
        });
        
        document.getElementById('adv-thickness').addEventListener('input', function() {
            document.getElementById('adv-thickness-value').textContent = this.value;
            calculateAdvancedProductivity();
        });
        
        document.getElementById('reservoir-type').addEventListener('change', function() {
            calculateAdvancedProductivity();
        });
        
        // Comparison tab sliders
        document.getElementById('comp-length').addEventListener('input', function() {
            document.getElementById('comp-length-value').textContent = this.value;
            calculateComparisonProductivity();
        });
        
        document.getElementById('comp-thickness').addEventListener('input', function() {
            document.getElementById('comp-thickness-value').textContent = this.value;
            calculateComparisonProductivity();
        });
        
        document.getElementById('comp-kh').addEventListener('input', function() {
            document.getElementById('comp-kh-value').textContent = this.value;
            calculateComparisonProductivity();
        });
        
        document.getElementById('comp-kv').addEventListener('input', function() {
            document.getElementById('comp-kv-value').textContent = this.value;
            calculateComparisonProductivity();
        });
        
        // Initialize calculations and charts
        window.onload = function() {
            calculateBasicProductivity();
            calculateAdvancedProductivity();
            calculateComparisonProductivity();
        };
    </script>
</body>
</html>