<html>
<head>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
        }
        h1, h2, h3 {
            color: #2c3e50;
        }
        h1 {
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
        }
        h2 {
            border-bottom: 1px solid #bdc3c7;
            padding-bottom: 5px;
            margin-top: 30px;
        }
        .simulator {
            background-color: #f9f9f9;
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 20px;
            margin: 20px 0;
        }
        .formula-box {
            background-color: #f5f5f5;
            border-left: 4px solid #3498db;
            padding: 10px 15px;
            margin: 15px 0;
        }
        .analogy {
            background-color: #e8f4f8;
            border-radius: 5px;
            padding: 15px;
            margin: 15px 0;
        }
        .analogy h4 {
            margin-top: 0;
            color: #2980b9;
        }
        img {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 20px auto;
        }
        .interactive {
            margin: 30px 0;
        }
        .slider-container {
            margin: 15px 0;
        }
        .slider-container label {
            display: inline-block;
            width: 200px;
        }
        canvas {
            border: 1px solid #ddd;
            margin: 15px 0;
        }
        button {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background-color: #2980b9;
        }
        .key-point {
            font-weight: bold;
            color: #e74c3c;
        }
        .conclusion {
            background-color: #f0f0f0;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <h1>Understanding Thermal Pressurization in SAGD Projects: A First Principles Approach</h1>
    
    <p>Have you ever wondered what happens when you heat water in a sealed container? The pressure builds up dramatically, potentially causing the container to burst. This same principle, known as thermal pressurization, plays a critical role in Steam-Assisted Gravity Drainage (SAGD) oil recovery projects and can lead to serious operational problems if not properly understood and managed.</p>
    
    <p>Today, we'll break down the complex physics of thermo-hydro-mechanical pressurization in low-permeability caprock formations during SAGD operations. We'll start from first principles, use intuitive analogies, and provide an interactive simulation to help visualize these concepts.</p>
    
    <h2>The Problem: Caprock Integrity in SAGD Operations</h2>
    
    <p>SAGD is a thermal recovery technique used to extract bitumen from oil sands. It involves injecting steam into the reservoir through a horizontal well, which heats the bitumen, reducing its viscosity and allowing it to flow to a production well below.</p>
    
    <p>However, as steam heats the reservoir and the caprock (the impermeable layer above the reservoir), a critical issue emerges: <span class="key-point">thermal pressurization</span>. This phenomenon can compromise caprock integrity and lead to steam releases, casing failures, and environmental issues.</p>
    
    <div class="analogy">
        <h4>Everyday Analogy: The Pressure Cooker Effect</h4>
        <p>Think of the caprock as the lid of a pressure cooker. When you heat water in a sealed pressure cooker, the water expands and some converts to steam, dramatically increasing the pressure. If the pressure release valve fails, the lid might burst off.</p>
        <p>Similarly, when steam heats the water in low-permeability caprock, the water expands but cannot easily escape (due to low permeability). This causes a significant pressure increase that can lead to caprock failure.</p>
    </div>
    
    <h2>The Physics: From First Principles</h2>
    
    <h3>1. What Causes Thermal Pressurization?</h3>
    
    <p>Thermal pressurization occurs when the thermal expansion of pore fluids exceeds that of the pore space. The pore space stiffness resists the expansion of the fluid, compressing it and increasing pore pressure.</p>
    
    <p>This is governed by three key properties:</p>
    <ul>
        <li>Thermal expansion coefficients of the fluid and rock matrix</li>
        <li>Compressibility of the fluid and rock matrix</li>
        <li>Permeability of the rock (determines how easily fluid can escape)</li>
    </ul>
    
    <h3>2. The Thermal Pressurization Coefficient</h3>
    
    <div class="formula-box">
        <p>The thermal pressurization coefficient (Λ) defines the increase in fluid pressure per unit change in temperature:</p>
        <p>\[ \Lambda = \frac{\phi\gamma_f + (1-\phi)\gamma_s - \gamma_{sf}}{\phi\beta_f - (1-\phi)\beta_s\alpha_{Biot} + \beta_{sf}} \]</p>
        <p>Where:</p>
        <ul>
            <li>\(\phi\) = porosity</li>
            <li>\(\gamma_f\) = thermal expansion coefficient of fluid</li>
            <li>\(\gamma_s\) = thermal expansion coefficient of solid grains</li>
            <li>\(\gamma_{sf}\) = thermal expansion coefficient of porous medium</li>
            <li>\(\beta_f\) = compressibility of fluid</li>
            <li>\(\beta_s\) = compressibility of solid grains</li>
            <li>\(\beta_{sf}\) = compressibility of porous medium</li>
            <li>\(\alpha_{Biot}\) = Biot coefficient</li>
        </ul>
    </div>
    
    <p>For formations with porosity greater than about 5%, the fluid thermal expansion dominates, and we can simplify to:</p>
    
    <div class="formula-box">
        <p>\[ \Lambda \approx \frac{\phi\gamma_f}{\phi\beta_f + \beta_{sf}} \]</p>
    </div>
    
    <h3>3. Phase Change Complications: Water to Steam</h3>
    
    <p>When water flashes to steam, it undergoes a dramatic volume increase (about 1,600 times at atmospheric pressure). In low-permeability caprocks where steam cannot easily escape, this creates enormous pressure.</p>
    
    <p>For vaporized steam in undrained conditions, the thermal pressurization factor becomes:</p>
    
    <div class="formula-box">
        <p>\[ \Lambda = \frac{\phi\gamma_{st}}{\phi\beta_{st}^{vap} + \beta_{sf}} = \frac{\phi\gamma_{st}}{\left[(1-\phi)\rho_s c_s + \phi\rho_w c_w\right]\left(\frac{1}{L_v\rho_{st}}\right)^2(T+273.15) + \beta_{sf}} \]</p>
        <p>Where:</p>
        <ul>
            <li>\(\gamma_{st}\) = thermal expansion coefficient of steam</li>
            <li>\(\beta_{st}^{vap}\) = compressibility due to phase change</li>
            <li>\(\rho_s\) = density of solid</li>
            <li>\(\rho_w\) = density of water</li>
            <li>\(c_s\) = heat capacity of solid</li>
            <li>\(c_w\) = heat capacity of water</li>
            <li>\(L_v\) = latent heat of vaporization</li>
        </ul>
    </div>
    
    <h3>4. Heat and Fluid Flow Equations</h3>
    
    <p>The governing equations for this system combine fluid mass conservation and thermal energy conservation:</p>
    
    <div class="formula-box">
        <p>Fluid Mass Conservation:</p>
        <p>\[ \kappa_{Hydraulic}\left(\frac{\partial^2 P}{\partial z^2}\right) - \kappa_{Hydraulic}\left[\gamma_f\left(\frac{\partial T}{\partial z}\right)\left(\frac{\partial P}{\partial z}\right)\right] + \Lambda\frac{\partial T}{\partial t} = \frac{\partial P}{\partial t} \]</p>
        
        <p>Thermal Energy Conservation (simplified for low Péclet number):</p>
        <p>\[ \kappa_{Thermal}\left(\frac{\partial^2 T}{\partial z^2}\right) = \frac{\partial T}{\partial t} \]</p>
        
        <p>Where:</p>
        <ul>
            <li>\(\kappa_{Hydraulic}\) = hydraulic diffusivity</li>
            <li>\(\kappa_{Thermal}\) = thermal diffusivity</li>
        </ul>
    </div>
    
    <h2>Interactive Simulation: Thermal Pressurization in Caprock</h2>
    
    <p>The simulation below demonstrates how temperature and pressure evolve in a caprock formation over time. Adjust the parameters to see how they affect thermal pressurization.</p>
    
    <div class="interactive">
        <div class="simulator">
            <h3>Thermal Pressurization Simulator</h3>
            
            <div class="slider-container">
                <label for="permeability">Permeability (log k):</label>
                <input type="range" id="permeability" min="-19" max="-16" step="0.5" value="-18">
                <span id="permeabilityValue">10<sup>-18</sup> m²</span>
            </div>
            
            <div class="slider-container">
                <label for="compressibility">Compressibility (log β):</label>
                <input type="range" id="compressibility" min="-10" max="-6" step="0.5" value="-8">
                <span id="compressibilityValue">10<sup>-8</sup> Pa<sup>-1</sup></span>
            </div>
            
            <div class="slider-container">
                <label for="porosity">Porosity (φ):</label>
                <input type="range" id="porosity" min="0.1" max="0.35" step="0.05" value="0.25">
                <span id="porosityValue">0.25</span>
            </div>
            
            <div class="slider-container">
                <label for="steamTemp">Steam Temperature:</label>
                <input type="range" id="steamTemp" min="150" max="270" step="10" value="200">
                <span id="steamTempValue">200°C</span>
            </div>
            
            <div class="slider-container">
                <label for="time">Time (days):</label>
                <input type="range" id="time" min="1" max="365" step="1" value="30">
                <span id="timeValue">30 days</span>
            </div>
            
            <div>
                <button id="runSimulation">Run Simulation</button>
                <button id="resetSimulation">Reset</button>
            </div>
            
            <div>
                <canvas id="pressureCanvas" width="800" height="300"></canvas>
                <div id="pressureLabel" style="text-align: center;">Pressure Profile in Caprock</div>
            </div>
            
            <div>
                <canvas id="temperatureCanvas" width="800" height="300"></canvas>
                <div id="temperatureLabel" style="text-align: center;">Temperature Profile in Caprock</div>
            </div>
        </div>
        
        <script>
            // Constants
            const initialTemp = 15; // Initial caprock temperature in °C
            const initialPressure = 2e6; // Initial pore pressure in Pa
            
            // Get DOM elements
            const permeabilitySlider = document.getElementById('permeability');
            const compressibilitySlider = document.getElementById('compressibility');
            const porositySlider = document.getElementById('porosity');
            const steamTempSlider = document.getElementById('steamTemp');
            const timeSlider = document.getElementById('time');
            
            const permeabilityValue = document.getElementById('permeabilityValue');
            const compressibilityValue = document.getElementById('compressibilityValue');
            const porosityValue = document.getElementById('porosityValue');
            const steamTempValue = document.getElementById('steamTempValue');
            const timeValue = document.getElementById('timeValue');
            
            const runButton = document.getElementById('runSimulation');
            const resetButton = document.getElementById('resetSimulation');
            
            const pressureCanvas = document.getElementById('pressureCanvas');
            const temperatureCanvas = document.getElementById('temperatureCanvas');
            const pressureCtx = pressureCanvas.getContext('2d');
            const temperatureCtx = temperatureCanvas.getContext('2d');
            
            // Update display values
            function updateDisplayValues() {
                permeabilityValue.innerHTML = `10<sup>${permeabilitySlider.value}</sup> m²`;
                compressibilityValue.innerHTML = `10<sup>${compressibilitySlider.value}</sup> Pa<sup>-1</sup>`;
                porosityValue.textContent = porositySlider.value;
                steamTempValue.textContent = `${steamTempSlider.value}°C`;
                timeValue.textContent = `${timeSlider.value} days`;
            }
            
            // Add event listeners
            permeabilitySlider.addEventListener('input', updateDisplayValues);
            compressibilitySlider.addEventListener('input', updateDisplayValues);
            porositySlider.addEventListener('input', updateDisplayValues);
            steamTempSlider.addEventListener('input', updateDisplayValues);
            timeSlider.addEventListener('input', updateDisplayValues);
            
            // Initialize display
            updateDisplayValues();
            
            // Run simulation
            runButton.addEventListener('click', runSimulation);
            resetButton.addEventListener('click', resetCanvas);
            
            function resetCanvas() {
                pressureCtx.clearRect(0, 0, pressureCanvas.width, pressureCanvas.height);
                temperatureCtx.clearRect(0, 0, temperatureCanvas.width, temperatureCanvas.height);
                
                // Draw axes for pressure canvas
                drawAxes(pressureCtx, 'Distance from Bottom of Caprock (m)', 'Pressure (MPa)');
                
                // Draw axes for temperature canvas
                drawAxes(temperatureCtx, 'Distance from Bottom of Caprock (m)', 'Temperature (°C)');
            }
            
            function drawAxes(ctx, xLabel, yLabel) {
                const padding = 50;
                
                ctx.beginPath();
                ctx.moveTo(padding, padding);
                ctx.lineTo(padding, ctx.canvas.height - padding);
                ctx.lineTo(ctx.canvas.width - padding, ctx.canvas.height - padding);
                ctx.strokeStyle = '#000';
                ctx.lineWidth = 2;
                ctx.stroke();
                
                // X-axis label
                ctx.fillStyle = '#000';
                ctx.textAlign = 'center';
                ctx.fillText(xLabel, ctx.canvas.width / 2, ctx.canvas.height - 15);
                
                // Y-axis label
                ctx.save();
                ctx.translate(15, ctx.canvas.height / 2);
                ctx.rotate(-Math.PI / 2);
                ctx.textAlign = 'center';
                ctx.fillText(yLabel, 0, 0);
                ctx.restore();
            }
            
            function runSimulation() {
                resetCanvas();
                
                // Get parameters
                const permeability = Math.pow(10, parseFloat(permeabilitySlider.value));
                const compressibility = Math.pow(10, parseFloat(compressibilitySlider.value));
                const porosity = parseFloat(porositySlider.value);
                const steamTemp = parseFloat(steamTempSlider.value);
                const time = parseFloat(timeSlider.value) * 24 * 3600; // Convert days to seconds
                
                // Calculate thermal and hydraulic diffusivity
                const thermalDiffusivity = 9.0e-7; // m²/s
                const waterViscosity = 0.001; // Pa·s
                const hydraulicDiffusivity = permeability / (waterViscosity * compressibility);
                
                // Calculate thermal pressurization coefficient
                const waterThermalExpansion = 7.0e-4; // 1/°C (approximate value)
                const Lambda = (porosity * waterThermalExpansion) / (porosity * 4.5e-10 + compressibility);
                
                // Simplified analytical solution parameters
                const thermalLength = Math.sqrt(4 * thermalDiffusivity * time);
                const maxDistance = 10; // meters
                const points = 100;
                const distanceStep = maxDistance / points;
                
                // Arrays to store results
                const distances = [];
                const temperatures = [];
                const pressures = [];
                
                // Calculate temperature and pressure profiles
                for (let i = 0; i <= points; i++) {
                    const distance = i * distanceStep;
                    distances.push(distance);
                    
                    // Dimensionless distance
                    const xi = distance / (2 * Math.sqrt(thermalDiffusivity * time));
                    
                    // Temperature profile using complementary error function
                    const temperature = initialTemp + (steamTemp - initialTemp) * erfc(xi);
                    temperatures.push(temperature);
                    
                    // Pressure profile
                    let pressureIncrease;
                    if (hydraulicDiffusivity > thermalDiffusivity) {
                        // High permeability case
                        pressureIncrease = Lambda * (steamTemp - initialTemp) * erfc(Math.sqrt(thermalDiffusivity / hydraulicDiffusivity) * xi);
                    } else {
                        // Low permeability case
                        const ratio = thermalDiffusivity / hydraulicDiffusivity;
                        pressureIncrease = Lambda * (steamTemp - initialTemp) * (erfc(Math.sqrt(ratio) * xi) - Math.sqrt(ratio) * erfc(xi)) / (1 - ratio);
                    }
                    
                    const pressure = initialPressure + pressureIncrease;
                    pressures.push(pressure);
                }
                
                // Draw temperature profile
                drawProfile(temperatureCtx, distances, temperatures, initialTemp, steamTemp, 'red');
                
                // Draw pressure profile
                const maxPressure = Math.max(...pressures);
                const minPressure = initialPressure;
                drawProfile(pressureCtx, distances, pressures, minPressure, maxPressure, 'blue');
                
                // Add steam interface indicator (simplified)
                const interfaceDistance = 0.5 * thermalLength;
                if (interfaceDistance < maxDistance) {
                    markInterface(pressureCtx, interfaceDistance, minPressure, maxPressure);
                    markInterface(temperatureCtx, interfaceDistance, initialTemp, steamTemp);
                }
            }
            
            function drawProfile(ctx, distances, values, minValue, maxValue, color) {
                const padding = 50;
                const xScale = (ctx.canvas.width - 2 * padding) / distances[distances.length - 1];
                const yScale = (ctx.canvas.height - 2 * padding) / (maxValue - minValue);
                
                ctx.beginPath();
                ctx.moveTo(padding, ctx.canvas.height - padding - (values[0] - minValue) * yScale);
                
                for (let i = 1; i < distances.length; i++) {
                    const x = padding + distances[i] * xScale;
                    const y = ctx.canvas.height - padding - (values[i] - minValue) * yScale;
                    ctx.lineTo(x, y);
                }
                
                ctx.strokeStyle = color;
                ctx.lineWidth = 2;
                ctx.stroke();
                
                // Add scale markers
                drawScaleMarkers(ctx, minValue, maxValue, distances[distances.length - 1]);
            }
            
            function drawScaleMarkers(ctx, minValue, maxValue, maxDistance) {
                const padding = 50;
                const xScale = (ctx.canvas.width - 2 * padding) / maxDistance;
                const yScale = (ctx.canvas.height - 2 * padding) / (maxValue - minValue);
                
                // X-axis markers
                for (let i = 0; i <= 10; i++) {
                    const x = padding + (i * maxDistance / 10) * xScale;
                    ctx.beginPath();
                    ctx.moveTo(x, ctx.canvas.height - padding);
                    ctx.lineTo(x, ctx.canvas.height - padding + 5);
                    ctx.stroke();
                    
                    ctx.fillText(i.toFixed(1), x, ctx.canvas.height - padding + 20);
                }
                
                // Y-axis markers
                const valueStep = (maxValue - minValue) / 5;
                for (let i = 0; i <= 5; i++) {
                    const value = minValue + i * valueStep;
                    const y = ctx.canvas.height - padding - i * valueStep * yScale;
                    
                    ctx.beginPath();
                    ctx.moveTo(padding, y);
                    ctx.lineTo(padding - 5, y);
                    ctx.stroke();
                    
                    // Format the value appropriately
                    let displayValue;
                    if (value >= 1e6) {
                        displayValue = (value / 1e6).toFixed(1);
                    } else if (value >= 1e3) {
                        displayValue = (value / 1e3).toFixed(1) + 'k';
                    } else {
                        displayValue = value.toFixed(1);
                    }
                    
                    ctx.fillText(displayValue, padding - 25, y + 5);
                }
            }
            
            function markInterface(ctx, distance, minValue, maxValue) {
                const padding = 50;
                const xScale = (ctx.canvas.width - 2 * padding) / 10; // Assuming max distance is 10m
                const x = padding + distance * xScale;
                
                ctx.beginPath();
                ctx.moveTo(x, padding);
                ctx.lineTo(x, ctx.canvas.height - padding);
                ctx.strokeStyle = 'green';
                ctx.setLineDash([5, 5]);
                ctx.lineWidth = 2;
                ctx.stroke();
                ctx.setLineDash([]);
                
                ctx.fillStyle = 'green';
                ctx.fillText('Steam Interface', x + 5, padding + 20);
            }
            
            // Complementary error function approximation
            function erfc(x) {
                const t = 1.0 / (1.0 + 0.3275911 * Math.abs(x));
                const tau = t * (0.254829592 + t * (-0.284496736 + t * (1.421413741 + t * (-1.453152027 + t * 1.061405429))));
                const erfcVal = (x >= 0) ? tau * Math.exp(-x * x) : 2.0 - tau * Math.exp(-x * x);
                return erfcVal;
            }
            
            // Initialize the canvas with axes
            resetCanvas();
        </script>
    </div>
    
    <h2>Key Insights from the Simulation</h2>
    
    <ol>
        <li><strong>Permeability Effect:</strong> Lower permeability caprocks (like Clearwater Formation) experience much higher thermal pressurization because fluid cannot easily escape from the heated zone.</li>
        
        <li><strong>Compressibility Effect:</strong> Stiffer caprocks (lower compressibility) experience higher thermal pressurization because they resist volume changes more strongly.</li>
        
        <li><strong>Time Evolution:</strong> The pressure and temperature profiles evolve over time, with the steam interface gradually moving upward into the caprock.</li>
        
        <li><strong>Phase Change Impact:</strong> When water vaporizes to steam, it creates a dramatic pressure increase that can be 5-15 times greater than the pressure increase from heating water alone.</li>
    </ol>
    
    <h2>Real-World Implications</h2>
    
    <h3>Why This Matters for SAGD Operations</h3>
    
    <p>Understanding thermal pressurization is crucial for several reasons:</p>
    
    <ol>
        <li><strong>Caprock Integrity:</strong> Excessive pressurization can cause shear failure in the caprock, leading to steam releases, casing failures, and environmental issues.</li>
        
        <li><strong>Maximum Operating Pressure:</strong> Thermal pressurization analysis helps determine safe maximum steam injection pressures for SAGD operations.</li>
        
        <li><strong>Formation-Specific Risks:</strong> Different formations (like Clearwater vs. McMurray) have different thermal pressurization characteristics, requiring tailored risk management approaches.</li>
        
        <li><strong>Operational Planning:</strong> Understanding how thermal pressurization evolves over time helps in planning safe and efficient SAGD operations.</li>
    </ol>
    
    <h3>The Joslyn Creek Incident</h3>
    
    <p>The importance of understanding thermal pressurization was highlighted by the catastrophic failure at the Joslyn Creek SAGD project in 2006. This incident led to regulatory changes and increased focus on caprock integrity assessments.</p>
    
    <div class="conclusion">
        <h3>Key Takeaways</h3>
        <ol>
            <li>Thermal pressurization is caused by the differential thermal expansion of pore fluids and the rock matrix.</li>
            <li>Low-permeability caprocks are more susceptible to thermal pressurization, not less, as was previously believed.</li>
            <li>Phase change from water to steam dramatically increases pressurization in undrained conditions.</li>
            <li>The key parameters controlling thermal pressurization are caprock permeability and compressibility.</li>
            <li>Different formations require different thermal pressurization analyses based on their specific properties.</li>
        </ol>
    </div>
    
    <p>By understanding the physics of thermal pressurization from first principles, engineers can better predict and mitigate risks in SAGD operations, ensuring both operational efficiency and environmental safety.</p>
    
    <p>The interactive simulation provided here offers a simplified but insightful way to explore how different parameters affect thermal pressurization. For real-world applications, more complex numerical simulations would be needed to account for heterogeneities, anisotropy, and other factors specific to each reservoir and caprock system.</p>
</body>
</html>