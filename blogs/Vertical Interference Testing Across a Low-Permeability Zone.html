<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Understanding Vertical Interference Testing: A First Principles Approach</title>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        h1, h2, h3 {
            color: #2c3e50;
        }
        h1 {
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
        }
        blockquote {
            border-left: 4px solid #3498db;
            padding-left: 20px;
            margin-left: 0;
            color: #555;
        }
        code {
            background-color: #f8f8f8;
            padding: 2px 4px;
            border-radius: 3px;
        }
        .highlight {
            background-color: #ffffd0;
            padding: 5px;
            border-radius: 5px;
        }
        .note {
            background-color: #e8f4f8;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
        }
        .equation-container {
            overflow-x: auto;
            margin: 20px 0;
        }
        figure {
            text-align: center;
            margin: 20px 0;
        }
        figcaption {
            font-style: italic;
            margin-top: 10px;
        }
        img {
            max-width: 100%;
        }
        #simulator {
            border: 1px solid #ddd;
            padding: 20px;
            margin: 30px 0;
            border-radius: 5px;
            background-color: #f9f9f9;
        }
        .slider-container {
            margin: 15px 0;
        }
        canvas {
            border: 1px solid #ccc;
            background-color: white;
        }
        button {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background-color: #2980b9;
        }
        .parameter-display {
            font-weight: bold;
            color: #2c3e50;
        }
    </style>
</head>
<body>
    <h1>Understanding Vertical Interference Testing: A First Principles Approach</h1>
    
    <p>Have you ever wondered how oil engineers determine if oil can flow between different layers of rock underground? Today, we're going to break down a fascinating technique called "Vertical Interference Testing" that helps engineers understand how fluids move through layered rock formations. This knowledge is crucial for making smart decisions about oil extraction.</p>
    
    <h2>The Problem: Understanding Flow Between Rock Layers</h2>
    
    <p>Imagine three layers of rock stacked on top of each other:</p>
    <ul>
        <li>Two permeable layers (like sandstone) that can easily transmit fluids</li>
        <li>Separated by a "tight" layer with low permeability (like shale) that restricts flow</li>
    </ul>
    
    <p>Oil companies need to know:</p>
    <ol>
        <li>How easily can oil flow horizontally through each permeable layer?</li>
        <li>How easily can oil flow vertically through the tight middle layer?</li>
        <li>How much oil crosses between layers during production?</li>
    </ol>
    
    <p>The answers to these questions affect drilling decisions, well completion strategies, and ultimately, how much oil can be recovered.</p>
    
    <div class="note">
        <strong>Key Insight:</strong> By measuring pressure changes in both layers while producing oil from just one layer, engineers can determine the flow properties of all three layers.
    </div>
    
    <h2>The Test Setup: A Clever Pressure Experiment</h2>
    
    <figure>
        <img src="https://i.ibb.co/wWCg3SJ/vertical-interference-test.png" alt="Vertical Interference Test Setup">
        <figcaption>Fig. 1: Model for single-well vertical interference test across a tight zone</figcaption>
    </figure>
    
    <p>Here's how the test works:</p>
    <ol>
        <li>A well is drilled through all three layers</li>
        <li>A packer (a kind of plug) is placed to isolate one permeable layer</li>
        <li>Oil is produced only from the other permeable layer</li>
        <li>Pressure is measured in <em>both</em> permeable layers over time</li>
    </ol>
    
    <p>As oil is produced from one layer, pressure drops in that layer. If the tight middle layer allows any flow at all, pressure will also begin to drop in the isolated layer as fluid crosses through the tight zone. By analyzing how these pressures change over time, we can determine the properties of all three layers.</p>
    
    <h2>The Physics: Flow Equations From First Principles</h2>
    
    <p>Let's break down the fundamental equations that govern fluid flow in this system. We start with the diffusivity equation, which describes how pressure changes propagate through a porous medium.</p>
    
    <div class="equation-container">
        <p>For the producing layer (Layer 1):</p>
        <p>\[ \frac{k_{1}h_{1}}{\mu}\nabla^{2}p_{1} = (\phi c_{t}h)_{1}\frac{\partial p_{1}}{\partial t} + \frac{k_{\nu}}{\mu\Delta h}(p_{2}-p_{1}) \]</p>
        
        <p>For the packed-off layer (Layer 2):</p>
        <p>\[ \frac{k_{2}h_{2}}{\mu}\nabla^{2}p_{2} = (\phi c_{t}h)_{2}\frac{\partial p_{2}}{\partial t} - \frac{k_{\nu}}{\mu\Delta h}(p_{2}-p_{1}) \]</p>
    </div>
    
    <p>Let's break down what each term means:</p>
    
    <ul>
        <li>\(k_1, k_2\) = horizontal permeability of each layer (how easily fluid flows horizontally)</li>
        <li>\(k_v\) = vertical permeability of the tight zone (how easily fluid crosses between layers)</li>
        <li>\(h_1, h_2\) = thickness of each permeable layer</li>
        <li>\(\Delta h\) = thickness of the tight zone</li>
        <li>\(\phi\) = porosity (percentage of rock that is empty space)</li>
        <li>\(c_t\) = total compressibility (how much the fluid and rock compress)</li>
        <li>\(\mu\) = fluid viscosity (how "thick" or resistant to flow the fluid is)</li>
        <li>\(p_1, p_2\) = pressure in each layer</li>
        <li>\(\nabla^2\) = the Laplacian operator (describes how pressure varies in space)</li>
    </ul>
    
    <div class="note">
        <strong>Physical Meaning:</strong> The left side of each equation represents horizontal flow within each layer. The right side has two terms: the first represents fluid storage (how pressure changes with time), and the second represents vertical flow between layers (crossflow).
    </div>
    
    <h2>Making the Equations Easier to Work With: Dimensionless Variables</h2>
    
    <p>To simplify the analysis, we convert all variables to dimensionless form. This makes the equations more general and easier to solve:</p>
    
    <div class="equation-container">
        <p>\[ p_{1D,2D} = \frac{(k_{1}h_{1}+k_{2}h_{2})}{\alpha_{p}q\mu}(p_{i}-p_{1,2}) \]</p>
        
        <p>\[ t_{D V} = {\frac{\alpha_{t}(k_{1}h_{1}+k_{2}h_{2})t}{[(\phi c_{t}h)_{1}+(\phi c_{t}h)_{2}]\mu r_{w}^{2}}} \]</p>
        
        <p>\[ r_{D} = r/r_{w} \]</p>
        
        <p>\[ \kappa = \frac{k_{1}h_{1}}{k_{1}h_{1}+k_{2}h_{2}} \]</p>
        
        <p>\[ \omega = \frac{(\phi c_{t}h)_{1}}{(\phi c_{t}h)_{1}+(\phi c_{t}h)_{2}} \]</p>
        
        <p>\[ \lambda = \frac{{r_{w}^{2}}}{(k_{1}h_{1}+k_{2}h_{2})}\frac{k_{\nu}}{\Delta h} \]</p>
        
        <p>\[ C_{D V} = \frac{\alpha_{c}C}{[(\phi c_{t}h)_{1}+(\phi c_{t}h)_{2}]r_{w}^{2}} \]</p>
    </div>
    
    <p>These dimensionless variables have important physical meanings:</p>
    <ul>
        <li>\(\kappa\) represents the fraction of total flow capacity in Layer 1</li>
        <li>\(\omega\) represents the fraction of total storage capacity in Layer 1</li>
        <li>\(\lambda\) represents how easily fluid can cross between layers</li>
        <li>\(C_{DV}\) represents wellbore storage effects (how fluid stored in the wellbore affects pressure measurements)</li>
    </ul>
    
    <p>The authors also define a parameter \(\beta\) related to the vertical communication:</p>
    
    <div class="equation-container">
        <p>\[ \beta = {\frac{\lambda}{4\kappa(1-\kappa)}} \]</p>
    </div>
    
    <h2>How Pressure Behaves During the Test</h2>
    
    <p>When we solve these equations, we find that pressure in both layers follows distinct patterns over time:</p>
    
    <h3>In the Producing Layer (Layer 1):</h3>
    <ol>
        <li><strong>Early time:</strong> Behaves like a single-layer system (influenced only by Layer 1 properties)</li>
        <li><strong>Late time:</strong> Behaves like a combined system of both layers with some added resistance</li>
    </ol>
    
    <h3>In the Packed-off Layer (Layer 2):</h3>
    <ol>
        <li><strong>Early time:</strong> Pressure drops very slowly with a characteristic "unit slope" on a log-log plot</li>
        <li><strong>Transition:</strong> Pressure drops more rapidly as the influence of both layers takes effect</li>
        <li><strong>Late time:</strong> Pressure drops at the same rate as Layer 1</li>
    </ol>
    
    <div class="note">
        <strong>Key Insight:</strong> By analyzing these pressure patterns, we can determine the properties of both permeable layers and the tight middle layer.
    </div>
    
    <h2>Crossflow Between Layers: A Fascinating Discovery</h2>
    
    <p>One of the most interesting findings from this research involves how fluid flows between layers during production. The authors discovered that:</p>
    
    <ol>
        <li>The reservoir can be divided into three distinct flow regions:</li>
        <ul>
            <li><strong>Inner region (r ≤ r<sub>eDV</sub>):</strong> Flow in Layer 2 is primarily vertical, moving toward Layer 1</li>
            <li><strong>Middle region:</strong> Flow in Layer 2 has both vertical and horizontal components</li>
            <li><strong>Outer region (r ≥ r<sub>eDH</sub>):</strong> Flow in both layers is primarily horizontal</li>
        </ul>
        <li>The total crossflow rate from Layer 2 to Layer 1 equals a fraction of the total production rate:</li>
        <div class="equation-container">
            <p>\[ q_{DV} = \frac{q_{\nu}}{q} = \frac{k_{2}h_{2}}{k_{1}h_{1}+k_{2}h_{2}} = 1-\kappa \]</p>
        </div>
    </ol>
    
    <p>This means that if Layer 2 represents 30% of the total flow capacity, then 30% of the produced fluid is actually coming from Layer 2, crossing through the tight middle layer to reach Layer 1.</p>
    
    <h2>Interactive Simulator: Vertical Interference Testing</h2>
    
    <div id="simulator">
        <h3>Vertical Interference Test Simulator</h3>
        
        <div class="slider-container">
            <label for="k1">Layer 1 Permeability (k₁): <span id="k1-value" class="parameter-display">100</span> md</label><br>
            <input type="range" id="k1" min="10" max="500" value="100" step="10">
        </div>
        
        <div class="slider-container">
            <label for="k2">Layer 2 Permeability (k₂): <span id="k2-value" class="parameter-display">50</span> md</label><br>
            <input type="range" id="k2" min="10" max="500" value="50" step="10">
        </div>
        
        <div class="slider-container">
            <label for="kv">Vertical Permeability (kᵥ): <span id="kv-value" class="parameter-display">0.1</span> md</label><br>
            <input type="range" id="kv" min="0.01" max="1" value="0.1" step="0.01">
        </div>
        
        <div class="slider-container">
            <label for="cd">Wellbore Storage (Cᴅ): <span id="cd-value" class="parameter-display">100</span></label><br>
            <input type="range" id="cd" min="0" max="1000" value="100" step="10">
        </div>
        
        <div>
            <button id="run-simulation">Run Simulation</button>
            <button id="reset-simulation">Reset</button>
        </div>
        
        <div>
            <h4>Simulation Results:</h4>
            <canvas id="pressure-plot" width="700" height="400"></canvas>
            <div id="results-text"></div>
        </div>
    </div>
    
    <h2>Practical Implications: Why This Matters</h2>
    
    <p>This research has several important practical applications:</p>
    
    <ol>
        <li><strong>Well Completion Decisions:</strong> Understanding vertical permeability helps engineers decide which layers to complete (open for production) and which to isolate.</li>
        <li><strong>Production Forecasting:</strong> Knowing how layers communicate allows better prediction of long-term production rates.</li>
        <li><strong>Enhanced Oil Recovery:</strong> For techniques like water flooding, understanding crossflow is crucial to predict where injected fluids will go.</li>
        <li><strong>Avoiding Water Problems:</strong> If one layer contains water, knowing the vertical permeability helps predict if and when water might break through to the oil-producing zones.</li>
    </ol>
    
    <h2>Conclusion: The Power of Pressure Analysis</h2>
    
    <p>The vertical interference test represents a powerful tool in the petroleum engineer's toolkit. By carefully measuring and analyzing pressure changes in a layered reservoir, engineers can:</p>
    
    <ul>
        <li>Determine the horizontal permeability of each permeable layer</li>
        <li>Calculate the vertical permeability of the tight middle layer</li>
        <li>Understand how fluid moves between layers during production</li>
        <li>Make better decisions about well completions and production strategies</li>
    </ul>
    
    <p>This approach illustrates how careful mathematical analysis of pressure data can reveal the hidden dynamics of fluid flow deep underground, allowing engineers to make more informed decisions about how to efficiently extract oil from complex layered reservoirs.</p>
    
    <script>
        // Update displayed values for sliders
        document.getElementById('k1').addEventListener('input', function() {
            document.getElementById('k1-value').textContent = this.value;
        });
        
        document.getElementById('k2').addEventListener('input', function() {
            document.getElementById('k2-value').textContent = this.value;
        });
        
        document.getElementById('kv').addEventListener('input', function() {
            document.getElementById('kv-value').textContent = this.value;
        });
        
        document.getElementById('cd').addEventListener('input', function() {
            document.getElementById('cd-value').textContent = this.value;
        });
        
        // Simulation code
        document.getElementById('run-simulation').addEventListener('click', runSimulation);
        document.getElementById('reset-simulation').addEventListener('click', resetSimulation);
        
        function resetSimulation() {
            document.getElementById('k1').value = 100;
            document.getElementById('k1-value').textContent = "100";
            document.getElementById('k2').value = 50;
            document.getElementById('k2-value').textContent = "50";
            document.getElementById('kv').value = 0.1;
            document.getElementById('kv-value').textContent = "0.1";
            document.getElementById('cd').value = 100;
            document.getElementById('cd-value').textContent = "100";
            
            const canvas = document.getElementById('pressure-plot');
            const ctx = canvas.getContext('2d');
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.font = '14px Arial';
            ctx.fillStyle = 'black';
            ctx.fillText('Run the simulation to see pressure vs. time plots', 200, 180);
            
            document.getElementById('results-text').innerHTML = '';
        }
        
        function runSimulation() {
            // Get parameter values
            const k1 = parseFloat(document.getElementById('k1').value);
            const k2 = parseFloat(document.getElementById('k2').value);
            const kv = parseFloat(document.getElementById('kv').value);
            const cd = parseFloat(document.getElementById('cd').value);
            
            // Calculate dimensionless parameters
            const h1 = 20; // Layer 1 thickness (ft)
            const h2 = 15; // Layer 2 thickness (ft)
            const dh = 10; // Tight zone thickness (ft)
            const rw = 0.3; // Wellbore radius (ft)
            
            const kappa = (k1 * h1) / (k1 * h1 + k2 * h2);
            const lambda = (rw * rw * kv) / ((k1 * h1 + k2 * h2) * dh);
            const beta = lambda / (4 * kappa * (1 - kappa));
            
            // Calculate crossflow rate
            const crossflowRate = 1 - kappa;
            
            // Generate time and pressure data
            const timePoints = [];
            const p1Points = []; // Producing layer
            const p2Points = []; // Packed-off layer
            
            // Generate logarithmically spaced time points
            for (let i = -2; i <= 3; i += 0.1) {
                timePoints.push(Math.pow(10, i));
            }
            
            // Simplified pressure calculation (this is a simplified model)
            timePoints.forEach(t => {
                // Early-time behavior for Layer 1 (wellbore storage + skin effect)
                const p1Early = 100 * Math.log10(1 + t / (0.01 * cd));
                
                // Late-time behavior for Layer 1 (total system response)
                const p1Late = 141.2 * Math.log10(t);
                
                // Transition between early and late time
                const transitionFactor = 1 / (1 + Math.exp(-(Math.log10(t) + 0.5)));
                const p1 = p1Early * (1 - transitionFactor) + p1Late * transitionFactor;
                p1Points.push(p1);
                
                // Layer 2 response (delayed from Layer 1)
                let p2;
                if (t < 0.01 / beta) {
                    // Very early time - minimal response
                    p2 = 0.01 * p1;
                } else if (t < 1 / beta) {
                    // Transition period - unit slope on log-log plot
                    p2 = 2 * beta * t * p1;
                } else {
                    // Late time - approaches Layer 1 pressure
                    p2 = p1 * (1 - Math.exp(-beta * t));
                }
                
                // Scale by vertical permeability effect
                p2 = p2 * (kv / 0.1);
                p2Points.push(p2);
            });
            
            // Draw the pressure plot
            const canvas = document.getElementById('pressure-plot');
            const ctx = canvas.getContext('2d');
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Set up axes
            const margin = 50;
            const plotWidth = canvas.width - 2 * margin;
            const plotHeight = canvas.height - 2 * margin;
            
            // Draw axes
            ctx.beginPath();
            ctx.moveTo(margin, margin);
            ctx.lineTo(margin, canvas.height - margin);
            ctx.lineTo(canvas.width - margin, canvas.height - margin);
            ctx.strokeStyle = 'black';
            ctx.lineWidth = 2;
            ctx.stroke();
            
            // X-axis label
            ctx.font = '14px Arial';
            ctx.fillStyle = 'black';
            ctx.fillText('Time (hours)', canvas.width / 2 - 40, canvas.height - 10);
            
            // Y-axis label
            ctx.save();
            ctx.translate(15, canvas.height / 2);
            ctx.rotate(-Math.PI / 2);
            ctx.fillText('Pressure Change (psi)', 0, 0);
            ctx.restore();
            
            // Draw grid lines
            ctx.beginPath();
            ctx.strokeStyle = '#ddd';
            ctx.lineWidth = 1;
            
            // Vertical grid lines (log scale)
            for (let i = -2; i <= 3; i++) {
                const x = margin + (i + 2) * plotWidth / 5;
                ctx.moveTo(x, margin);
                ctx.lineTo(x, canvas.height - margin);
                ctx.fillText(`10^${i}`, x - 10, canvas.height - margin + 20);
            }
            
            // Horizontal grid lines
            const maxPressure = Math.max(...p1Points);
            for (let i = 0; i <= 5; i++) {
                const y = canvas.height - margin - (i * plotHeight / 5);
                ctx.moveTo(margin, y);
                ctx.lineTo(canvas.width - margin, y);
                ctx.fillText(`${Math.round(i * maxPressure / 5)}`, margin - 35, y + 5);
            }
            ctx.stroke();
            
            // Plot Layer 1 pressure
            ctx.beginPath();
            ctx.strokeStyle = 'blue';
            ctx.lineWidth = 2;
            for (let i = 0; i < timePoints.length; i++) {
                const x = margin + (Math.log10(timePoints[i]) + 2) * plotWidth / 5;
                const y = canvas.height - margin - (p1Points[i] / maxPressure) * plotHeight;
                if (i === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
            }
            ctx.stroke();
            
            // Plot Layer 2 pressure
            ctx.beginPath();
            ctx.strokeStyle = 'red';
            ctx.lineWidth = 2;
            for (let i = 0; i < timePoints.length; i++) {
                const x = margin + (Math.log10(timePoints[i]) + 2) * plotWidth / 5;
                const y = canvas.height - margin - (p2Points[i] / maxPressure) * plotHeight;
                if (i === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
            }
            ctx.stroke();
            
            // Add legend
            ctx.fillStyle = 'blue';
            ctx.fillRect(canvas.width - 120, 20, 15, 15);
            ctx.fillStyle = 'black';
            ctx.fillText('Layer 1 (Producing)', canvas.width - 100, 32);
            
            ctx.fillStyle = 'red';
            ctx.fillRect(canvas.width - 120, 45, 15, 15);
            ctx.fillStyle = 'black';
            ctx.fillText('Layer 2 (Packed-off)', canvas.width - 100, 57);
            
            // Display calculated parameters
            let resultsHTML = `
                <p><strong>Calculated Parameters:</strong></p>
                <ul>
                    <li>κ (kappa) = ${kappa.toFixed(3)} - Fraction of flow capacity in Layer 1</li>
                    <li>λ (lambda) = ${lambda.toExponential(3)} - Vertical communication factor</li>
                    <li>β (beta) = ${beta.toExponential(3)} - Dimensionless vertical communication</li>
                    <li>Crossflow Rate = ${(crossflowRate * 100).toFixed(1)}% of total production</li>
                </ul>
                <p><strong>Interpretation:</strong> ${interpretResults(kappa, beta, kv)}</p>
            `;
            
            document.getElementById('results-text').innerHTML = resultsHTML;
        }
        
        function interpretResults(kappa, beta, kv) {
            let interpretation = "";
            
            if (kv < 0.05) {
                interpretation += "The vertical permeability is very low, indicating poor communication between layers. ";
            } else if (kv < 0.2) {
                interpretation += "The vertical permeability indicates moderate communication between layers. ";
            } else {
                interpretation += "The vertical permeability is high, indicating good communication between layers. ";
            }
            
            if (kappa > 0.8) {
                interpretation += "Layer 1 dominates the flow capacity, with minimal contribution from Layer 2. ";
            } else if (kappa < 0.2) {
                interpretation += "Layer 2 dominates the flow capacity, despite being packed off. ";
            } else {
                interpretation += "Both layers contribute significantly to the total flow capacity. ";
            }
            
            if (beta < 1e-8) {
                interpretation += "The test would need to run for a very long time to observe communication between layers.";
            } else if (beta < 1e-6) {
                interpretation += "Communication between layers would be observable in a standard-length test.";
            } else {
                interpretation += "Communication between layers would be quickly observable in the test.";
            }
            
            return interpretation;
        }
        
        // Initialize with empty plot
        resetSimulation();
    </script>
</body>
</html>